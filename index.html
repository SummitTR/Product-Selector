
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Summit Tractors – Product Learning Center</title>
<style>
    :root {
      --brand: #254A4F;
      --bg: #f7faf9;
      --card: #ffffff;
      --text: #1a1a1a;
      --muted: #6b7280;
      --ring: rgba(37,74,79,0.3);
    
  // Existing handlers
  els('[data-add]').forEach(b => b.onclick = () => toggleAttachment(b.getAttribute('data-add'), b));
  els('[data-preview]').forEach(b => b.onclick = () => openProductModal(b.getAttribute('data-preview')));
  // See Details handler
  els('[data-details], [data-toggle-details]').forEach(b => {
    const id = b.getAttribute('data-details') || b.getAttribute('data-toggle-details');
    b.onclick = () => {
      const p = getProd(id);
      if (!p) return;
      el('#modalTitle').textContent = p.ProductName || 'Details';
      el('#modalContent').innerHTML = buildDetailCard(p);
      el('#modal').style.display = 'flex';
    };
  });

}
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: var(--text); background: var(--bg); }
    /* Overlay */
    .overlay { position: fixed; inset: 0; background: var(--brand); color: #fff; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:12px; z-index: 1000; }
    .spinner { width: 44px; height: 44px; border: 4px solid rgba(255,255,255,0.35); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    header.appbar { position: sticky; top: 0; z-index: 50; background: var(--brand); color: #fff; padding: 10px 16px; display: flex; align-items: center; gap: 12px; }
    header .logo { font-weight: 700; letter-spacing: 0.5px; }
    header .grow { flex: 1; }
    header .controls > * { margin-left: 8px; }
    button, .btn { background: var(--brand); color: #fff; border: none; border-radius: 10px; padding: 10px 14px; cursor: pointer; font-weight: 600; }
    button.secondary { background: #e5efef; color: var(--brand); }
    button.ghost { background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.4); }
    button:focus, .btn:focus { outline: 2px solid var(--ring); outline-offset: 2px; }
    main { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .grid { display: grid; gap: 16px; }
    @media (min-width: 640px) { .grid.cols-2 { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 960px) { .grid.cols-3 { grid-template-columns: repeat(3, 1fr); } }
    .card { background: var(--card); border-radius: 14px; box-shadow: 0 4px 16px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid #e8eeee; }
    .card .media { height: 180px; background: #eef3f3; display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .card .media img { max-width: 100%; max-height: 100%; object-fit: contain; }
    .card .body { padding: 12px; }
    .muted { color: var(--muted); }
    nav.steps { display:flex; gap:8px; flex-wrap:wrap; margin: 12px 0 0; }
    .step { background:#e5efef; color: var(--brand); border-radius: 999px; padding: 8px 12px; font-weight:600; cursor:pointer; }
    .step.active { background: var(--brand); color:#fff; }
    section.screen { display:none; }
    section.screen.active { display:block; }
    .welcome { display:flex; align-items:center; justify-content:center; min-height: 60vh; text-align:center; }
    .welcome .hero { background:#e5efef; border-radius:18px; padding:24px; }
    .carousel { display:grid; grid-template-columns: 56px 1fr 56px; gap:8px; align-items:center; }
    .carousel .pane { background: var(--card); border-radius:14px; padding: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.06); border: 1px solid #e8eeee; }
    .thumbs { display:flex; gap:8px; overflow:auto; padding: 6px 0; }
    .thumbs img { height: 56px; width: 56px; object-fit: cover; border-radius: 10px; border:2px solid transparent; cursor: pointer; }
    .thumbs img.active { border-color: var(--brand); }
    .toolbar { display:flex; gap: 8px; align-items:center; flex-wrap: wrap; margin: 12px 0; }
    .pill { padding: 6px 10px; border-radius: 999px; background:#e5efef; cursor:pointer; }
    .pill.active { background: var(--brand); color:#fff; }
    .kbadges { display:flex; gap:8px; flex-wrap:wrap; }
    .kbadge { background:#e5efef; padding:6px 10px; border-radius:999px; }
    .modal { position: fixed; inset:0; background: rgba(0,0,0,0.5); display:none; align-items:center; justify-content:center; padding:16px; }
    .modal .dialog { background:#fff; border-radius:12px; max-width: 900px; width: 100%; max-height: 90vh; overflow:auto; }
    .dialog header { padding: 12px 16px; border-bottom: 1px solid #eee; display:flex; align-items:center; justify-content:space-between; }
    .dialog .content { padding: 12px 16px; }
    .actions { display:flex; gap:8px; flex-wrap: wrap; }
    .sticky-actions { position: sticky; bottom: 0; background: #fff; padding: 12px; border-top: 1px solid #eee; display:flex; gap:8px; }
    .hidden { display:none !important; }
    input, select, textarea { width: 100%; padding: 10px 12px; border: 1px solid #dfe6e6; border-radius: 8px; }
    @media print {
      header.appbar, nav.steps, .toolbar, .sticky-actions, .no-print { display:none !important; }
      body { background: #fff; }
      .card { box-shadow: none; border: 1px solid #ddd; }
    }
  
/* === BEGIN: Overrides (image sizing, header steps, modal, toast) === */
.carousel .pane .media {
  height: clamp(220px, 40vh, 420px);
  display:flex; align-items:center; justify-content:center;
  background:#eef3f3; overflow:hidden;
}
.carousel .pane .media img { width:100%; height:100%; max-width:100%; max-height:100%; object-fit:contain; }
.card .media { height: clamp(160px, 28vh, 260px); background:#eef3f3; display:flex; align-items:center; justify-content:center; overflow:hidden; }
.card .media img { max-width:100%; max-height:100%; object-fit:contain; }
.modal .dialog { background:#fff; border-radius:12px; max-width:900px; width:100%; max-height:90vh; overflow:auto; display:flex; flex-direction:column; }
.dialog .content .media { max-height:70vh; display:flex; align-items:center; justify-content:center; overflow:hidden; }
.dialog .content .media img, .dialog .content iframe, .dialog .content video { max-width:100%; max-height:100%; object-fit:contain; }
/* Header steps as simple text links with underline for active */
nav.steps .step { background:transparent!important; border:none!important; color:#fff!important; padding:8px 12px; border-radius:0!important; }
nav.steps .step.active { text-decoration:underline; }
/* Toast */
.toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%) translateY(12px);background:var(--brand,#254A4F);color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.18);opacity:0;pointer-events:none;transition:opacity .25s, transform .25s;z-index:1001;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
@media (max-width:639px){ .carousel { grid-template-columns:44px 1fr 44px; } .carousel .pane .media { height:clamp(180px,35vh,320px);} }
@media (min-width:960px){ .carousel .pane .media { height:clamp(260px,38vh,460px);} }
/* === END: Overrides === */

/* Header brand block: logo + two-line title */
header.appbar .brand { display:flex; align-items:center; gap:12px; }
header.appbar .brand-logo { height:64px; width:auto; display:block; }
header.appbar .brand-title { display:flex; flex-direction:column; justify-content:space-between; height:64px; }
header.appbar .brand-title .brand-top,
header.appbar .brand-title .brand-bottom { line-height:1; margin:0; padding:0; }
header.appbar .brand-title .brand-top { font-size:28px; font-weight:800; letter-spacing:0.2px; }
header.appbar .brand-title .brand-bottom { font-size:28px; font-weight:700; opacity:.95; }

@media (max-width: 640px){
  header.appbar .brand-logo { height:52px; }
  header.appbar .brand-title { height:52px; }
  header.appbar .brand-title .brand-top,
  header.appbar .brand-title .brand-bottom { font-size:22px; }
}

/* Overlay close button on the player */
.dialog .content { position: relative; }
.player-close{
  position:absolute; top:8px; right:8px;
  background: rgba(0,0,0,.6); color:#fff;
  border: 1px solid rgba(255,255,255,.35);
  border-radius: 999px; width: 32px; height: 32px;
  line-height: 30px; text-align: center; font-weight: 700;
  cursor: pointer;
}
.player-close:focus{ outline:2px solid var(--ring); outline-offset:2px; }

/* Selected card highlight & badge */
.card, .pane { position: relative; }
.selected {
  border: 2px solid var(--ring, #3b82f6);
  box-shadow: 0 0 0 3px rgba(59,130,246,0.15);
  border-radius: 12px;
}
.sel-badge{
  position:absolute; top:8px; left:8px;
  width:28px; height:28px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  background: var(--ring, #3b82f6); color:#fff; font-weight:700;
  box-shadow: 0 2px 6px rgba(0,0,0,0.25);
}

/* Selected card highlight & badge */
.card.selected, .pane.selected {
  border: 3px solid #254a4f !important;
  position: relative;
  border-radius: 12px;
}
.card.selected::before, .pane.selected::before {
  content: "✓";
  position: absolute;
  top: 8px; left: 8px;
  background: #254a4f;
  color: #fff;
  font-weight: bold;
  border-radius: 50%;
  width: 24px; height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
}

/* Style Enter Learning Center buttons */
button[data-enterlc] {
  background-color: #254a4f !important;
  color: #ffffff !important;
  border: none !important;
}
button[data-enterlc]:hover {
  opacity: 0.9;
}

/* Force brand style for all Enter Learning Center buttons */
button[data-enterlc],
button[data-enterlc].secondary {
  background-color: #254a4f !important;
  color: #ffffff !important;
  border: none !important;
}
button[data-enterlc]:hover,
button[data-enterlc].secondary:hover {
  background-color: #254a4f !important;
  color: #ffffff !important;
  opacity: 0.9;
}

/* Force brand style for the top-row Enter Learning Center button */
#attachmentsControls button#enterLearningCenter,
#attachmentsControls button#enterLearningCenter.secondary {
  background-color: #254a4f !important;
  color: #ffffff !important;
  border: none !important;
}
#attachmentsControls button#enterLearningCenter:hover,
#attachmentsControls button#enterLearningCenter.secondary:hover {
  background-color: #254a4f !important;
  color: #ffffff !important;
  opacity: 0.9;
}

/* FINAL explicit style for toolbar Enter Learning Center button */
#attachmentsControls #enterLearningCenter {
  background-color: #254a4f !important;
  color: #ffffff !important;
  border: none !important;
}
#attachmentsControls #enterLearningCenter:hover {
  background-color: #254a4f !important;
  color: #ffffff !important;
  opacity: 0.9;
}

/* Brand style for the Step 2 toolbar Enter Learning Center button */
#screen-step2 .toolbar #toStep3,
#screen-step2 .toolbar #toStep3.secondary,
#screen-step2 .toolbar button[data-enterlc] {
  background-color: #254a4f !important;
  color: #ffffff !important;
  border: none !important;
}
#screen-step2 .toolbar #toStep3:hover,
#screen-step2 .toolbar #toStep3.secondary:hover,
#screen-step2 .toolbar button[data-enterlc]:hover {
  background-color: #254a4f !important;
  color: #ffffff !important;
  opacity: 0.9;
}

/* === Mobile Smart Header + Bottom Step Bar === */
@media (max-width: 768px) {
  header, .app-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    transition: transform .25s ease;
    will-change: transform;
  }
  .mobile-header-hidden {
    transform: translateY(-100%);
  }
  .mobile-stepbar {
    position: sticky;
    bottom: 0;
    z-index: 1000;
    display: flex;
    gap: 8px;
    align-items: center;
    justify-content: space-between;
    padding: 8px;
    background: #ffffffE6; /* slightly translucent */
    backdrop-filter: blur(6px);
    box-shadow: 0 -6px 18px rgba(0,0,0,0.08);
    border-top: 1px solid rgba(0,0,0,0.06);
  }
  .mobile-stepbar button {
    flex: 1 1 0;
    border-radius: 999px;
    padding: 10px 12px;
    font-weight: 600;
    border: 1px solid rgba(0,0,0,0.08);
    background: #f4f6f7;
  }
  .mobile-stepbar button.active {
    background: #254a4f;
    color: #fff;
    border-color: #254a4f;
  }
  .mobile-stepbar .badge {
    display: inline-block;
    min-width: 20px;
    padding: 0 6px;
    margin-left: 6px;
    border-radius: 999px;
    font-size: 12px;
    line-height: 18px;
    text-align: center;
    background: #254a4f;
    color: #fff;
    vertical-align: middle;
  }
}

/* === Mobile header declutter === */
@media (max-width: 768px) {
  header.appbar {
    padding: 8px 12px !important;
    min-height: auto;
  }
  .appbar .brand-logo { height: 24px; width: auto; }
  .appbar .brand-bottom { display: none !important; } /* hide long subtitle */
  .appbar .controls { display: none !important; }     /* hide Import/Share/Print on mobile */
  .appbar nav.grow, .appbar .steps { display: none !important; } /* hide step bubbles in header */
}

/* === Selected state (brand) === */
.card, .pane { position: relative; }
.card.selected, .pane.selected {
  border: 3px solid #254A4F !important;
  box-shadow: 0 0 0 3px rgba(37,74,79,0.12) !important;
  border-radius: 14px !important;
}
.card.selected::after, .pane.selected::after {
  content: "";
  position: absolute;
  top: 8px; left: 8px;
  width: 28px; height: 28px; border-radius: 50%;
  background-color: #fff; border: 2px solid #254A4F;
  background-repeat: no-repeat; background-position: center; background-size: 18px 18px;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%23254A4F" d="M9.0 16.2l-3.5-3.5-1.4 1.4L9.0 19 20 8l-1.4-1.4z"/></svg>');
  z-index: 2;
}

/* Styled Key Features list */
.kfeatures {
  list-style: none;
  margin: 8px 0;
  padding: 0;
}
.kfeatures li {
  position: relative;
  padding-left: 24px;
  margin-bottom: 6px;
  line-height: 1.4;
}
.kfeatures li::before {
  content: "✓";
  position: absolute;
  left: 0;
  top: 0;
  color: #254A4F;
  font-weight: bold;
}

/* --- Ensure header shows logo + 3-item menu on one row --- */
header { display: flex; align-items: center; gap: 16px; }
header .grow { flex: 1; }
header .steps { display: flex; gap: 12px; flex-wrap: wrap; }
header .steps .step { cursor: pointer; padding: 8px 12px; border-radius: 999px; border: 1px solid #dbe4e4; }
.welcome .hero { border: 2px solid #254a4f; }
</style>
<script>

// Collect images from either ImageURLs or Image1..ImageN (case-insensitive)
function getImages(row){
  if (!row) return [];
  // Prefer ImageURLs if present and non-empty
  if (row.ImageURLs && String(row.ImageURLs).trim()) {
    if (typeof splitMedia === 'function') return splitMedia(row.ImageURLs);
    return String(row.ImageURLs).split(/[;,]/).map(s=>s.trim()).filter(Boolean);
  }
  // Fallback: gather Image1, Image2, ... Image99 (case-insensitive)
  const imgs = [];
  const keys = Object.keys(row || {});
  keys.forEach(k => {
    const m = /^image\s*(\d+)$/i.exec(k);
    if (m) {
      const n = parseInt(m[1], 10);
      const val = String(row[k] || '').trim();
      if (val) imgs.push({ n, url: val });
    }
  });
  imgs.sort((a,b)=> a.n - b.n);
  return imgs.map(x => x.url);
}

</script>
<style>
/* === Modal styles === */
.modal.hidden{ display:none; }
.modal{ position:fixed; inset:0; z-index:9999; }
.modal-backdrop{ position:absolute; inset:0; background:rgba(17,24,39,.5); }
.modal-dialog{
  position:relative; margin:8vh auto 0; max-width:640px; background:#fff;
  border-radius:14px; box-shadow:0 20px 40px rgba(0,0,0,.18); overflow:hidden;
}
.modal-header{ padding:14px 18px; border-bottom:1px solid #eef2f2; display:flex; align-items:center; justify-content:space-between; }
.modal-header h3{ margin:0; font-size:18px; }
.modal-close{ background:transparent; border:none; font-size:26px; line-height:1; cursor:pointer; }
.modal-body{ padding:16px 18px; }
.modal-body ul{ margin:0 0 10px 18px; }
.modal-body .muted{ color:#6b7280; margin-top:8px; }
.modal-footer{ padding:12px 18px; border-top:1px solid #eef2f2; display:flex; justify-content:flex-end; gap:10px; }
.modal-footer .primary{ background:#254A4F; color:#fff; border:none; border-radius:999px; padding:10px 14px; font-weight:700; cursor:pointer; }
.modal-footer .secondary{ background:#fff; color:#254A4F; border:1px solid #254A4F; border-radius:999px; padding:10px 14px; font-weight:700; cursor:pointer; }
@media (max-width: 700px){
  .modal-dialog{ margin:6vh 12px 0; }
}
/* Ensure header layout with logo + menu stays intact */
header .grow .steps{ display:flex; gap:14px; flex-wrap:wrap; align-items:center; }
header .grow .step{ cursor:pointer; padding:8px 10px; border-radius:999px; }
header .grow .step:hover{ background:#eef3f3; }
</style>
<style>
button.see-details{
  background:#ffb703;
  color:#1a1a1a;
  border:none;
  border-radius:10px;
  padding:10px 14px;
  font-weight:800;
}
button.see-details:hover{ opacity:.9 }
button.see-details:focus{ outline:2px solid var(--ring, rgba(37,99,235,.35)); outline-offset:2px }


/* Prominent See Details button (non-invasive) */
button.see-details{
  background:#ffb703;
  color:#1a1a1a;
  border:none;
  border-radius:10px;
  padding:10px 14px;
  font-weight:800;
}
button.see-details:hover{ opacity:.9 }
button.see-details:focus{ outline:2px solid var(--ring, rgba(37,99,235,.35)); outline-offset:2px }
</style>
<style>
  /* Default: hide the mobile/tablet footer menu on large screens */
  .mobile-stepbar { display: none; }

  /* Tablet & Mobile (≤1024px): show footer menu, make header non-sticky */
  @media (max-width: 1024px) {
    .mobile-stepbar { display: flex; }
    header.appbar, header, .app-header { position: static !important; top:auto !important; }
  }

  /* Desktop (≥1025px): ensure footer menu never shows */
  @media (min-width: 1025px) {
    .mobile-stepbar { display: none !important; }
  }
</style>
<!-- MOBILE_TABLET_OVERRIDES START -->
<style></style>
<!-- MOBILE_TABLET_OVERRIDES END -->
<style>
/* --- Mobile Stepbar Override --- */
.mobile-stepbar{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  display: flex !important;
  gap: 8px;
  padding: 10px;
  background: #fff;
  border-top: 1px solid #e5e7eb;
  z-index: 1000;
}
.mobile-stepbar button{
  flex: 1 1 0;
  min-height: 48px;
  border-radius: 12px;
  border: 1px solid rgba(37,74,79,.2);
  background: #254A4F;
  color: #fff;
  font-weight: 700;
}
.mobile-stepbar button:focus-visible{
  outline: 3px solid #2D666E;
  outline-offset: 2px;
}
.mobile-stepbar .badge{ display:none !important; }
</style><style id="header-menu-textonly">
/* Make top header menu look like plain text, non-clickable, without pills */
header.appbar .steps .step {
  background: transparent !important;
  color: var(--ink, #1b1f23) !important;
  border-radius: 0 !important;
  padding: 0 !important;
  margin-right: 14px !important;
  cursor: default !important;
  pointer-events: none !important;
  user-select: none !important;
  box-shadow: none !important;
  text-decoration: none !important;
  border: none !important;
}
header.appbar .steps .step::before,
header.appbar .steps .step::after { display: none !important; }
</style>
<style id="header-text-white">
/* Force every piece of text in the top header to pure white */
header.appbar, header.appbar * { 
  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important; /* handles cases where text-fill is used */
}
/* Pseudo-elements */
header.appbar *::before, header.appbar *::after {
  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important;
}
/* Common UI bits that sometimes override color */
header.appbar .step, header.appbar .step *, 
header.appbar .steps, header.appbar .steps *,
header.appbar .label, header.appbar .label *,
header.appbar .badge, header.appbar .badge *,
header.appbar .pill, header.appbar .pill *,
header.appbar .chip, header.appbar .chip *,
header.appbar .btn, header.appbar .btn *,
header.appbar .controls, header.appbar .controls *,
header.appbar .brand, header.appbar .brand *,
header.appbar nav, header.appbar nav * {
  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important;
}
/* Links in header */
header.appbar a:link, header.appbar a:visited, header.appbar a:hover, header.appbar a:active {
  color: #ffffff !important;
}
/* SVG icons */
header.appbar svg { fill: #ffffff !important; stroke: #ffffff !important; }
/* Form placeholders (if any search or input exists in header) */
header.appbar ::placeholder { color: #ffffff !important; opacity: 0.85; }
/* Ensure header doesn't inherit conflicting CSS variables */
header.appbar {
  --text: #ffffff;
  --fg: #ffffff;
  --color: #ffffff;
}
</style>
<style>
  /* Hide deprecated Step 2 (Benefits) screen safely */
  #screen-contact { display: none !important; }
</style>
<style>
  /* Hide disabled steps (per request): Step 4 and Step 5b */
  #screen-step3,
  #screen-contact {
    display: none !important;
  }
</style>
<style>
/* Welcome screen product thumbnail grid (CSV-driven) */
.welcome-product-grid { margin-top: 1.5rem; }
.welcome-product-grid > h3 { margin: 0 0 0.75rem 0; font-size: 1.125rem; }
.welcome-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 12px;
}
.welcome-thumb {
  margin: 0;
  padding: 8px;
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 10px;
  background: #e5efef;
  text-align: center;
}
.welcome-thumb img {
  width: 100%;
  height: 110px;
  object-fit: cover;
  border-radius: 8px;
  border: 2px solid #254a4f;
}
@media (min-width: 992px) {
  .welcome-grid { gap: 14px; }
  .welcome-thumb img { height: 130px; }
}</style><style>
/* --- Mobile safe spacing for Step 5a (Contact Intro) --- */
#screen-contact-intro {
  /* Ensure screen can scroll on small viewports */
  min-height: 100dvh;
  overflow-y: auto;
  /* Add extra bottom space so the footer doesn't cover the Proceed button */
  padding-bottom: max(120px, env(safe-area-inset-bottom, 0px) + 120px);
}

@supports not (padding-bottom: max(0px, 0px)) {
  /* Fallback for older browsers */
  #screen-contact-intro { padding-bottom: 140px; }
}

/* If the Proceed button is inside a sticky actions bar, ensure it rises above footer */
#screen-contact-intro .sticky-actions {
  position: sticky;
  bottom: calc(env(safe-area-inset-bottom, 0px) + 0px);
  z-index: 20;
}

/* Make sure any footer with fixed positioning sits beneath sticky actions */
footer, .footer, .mobile-footer {
  z-index: 10;
}
</style><style id="welcome-thumb-style-patch">
/* Header: align logo and label vertically centered across devices */
header .brand, .header .brand, .topbar .brand {
  display: flex;
  align-items: center;
  gap: 10px;
}
.brand-title, .brand-title .brand-top {
  line-height: 1.1;
}

/* Welcome container header color */
.welcome .hero h1,
#screen-welcome h1 {
  color: #254a4f !important;
}

/* Welcome thumbnails: remove image border, add container border */
.welcome-thumb {
  border: 2px solid #254a4f !important;
  border-radius: 10px;
  background: #e5efef; /* keep the light green background */
  padding: 8px;
}
.welcome-thumb img {
  border: none !important;
  border-radius: 8px;
  width: 100%;
  height: 110px;
  object-fit: cover;
}
@media (min-width: 992px) {
  .welcome-thumb img { height: 130px; }
}
</style><style id="header-desktop-tablet-patch">
/* Header tweaks: desktop & tablet only; keep mobile the same */
.brand-title-desktop { display: none; 
.brand-title-mobile { display: block; }


  .appbar .brand {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .brand-title-desktop { 
    display: block; 
    line-height: 1.05;
  }
  .brand-title-mobile { display: none; }
  .brand-line {
    font-weight: 700;
    /* Use similar scale to existing header; adjust as needed */
    font-size: clamp(20px, 2.2vw, 30px);
    color: #fff;
  }
  .here-you-can {
    font-weight: 700;
    font-size: clamp(20px, 2.2vw, 30px);
    color: #fff;
    white-space: nowrap;
  }
}

.appbar .brand {
  display: flex;
  align-items: center;
}
.brand-title-desktop {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

  font-size: 1em;
  font-weight: 700;
  color: #fff;
  margin-top: 2px;
}</style></head>
<body>
<!-- Loading Overlay -->
<div class="overlay" id="overlay">
<div class="spinner"></div>
<div class="msg">Loading…</div>
</div>
<header class="appbar">
<div class="brand">
<img alt="Summit Tractors Logo" class="brand-logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAj0AAADICAIAAACMM8fVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDcuMS1jMDAwIDc5LmVkYTJiM2ZhYywgMjAyMS8xMS8xNy0xNzoyMzoxOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphNjFhZjdjNC01M2ExLTg3NDMtYTk5Zi1iMmYwMzJhMjg0ODYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUNCQzcwNTA5RDdBMTFFREFFMzdDRDU5Q0M0OEMyNEUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUNCQzcwNEY5RDdBMTFFREFFMzdDRDU5Q0M0OEMyNEUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjEgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDBDNzQ5MUI1QzU4MTFFREEyMjNFQUIyQTVGM0I5QkMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDBDNzQ5MUM1QzU4MTFFREEyMjNFQUIyQTVGM0I5QkMiLz4gPC9yZGY6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"/>
<div class="brand-title"><div class="brand-title-desktop"><div class="brand-line brand-line1">Summit Tractors Product Learning Center</div></div></div>
<div class="brand-bottom"></div>
</div>
<nav class="grow"><div class="steps"><div class="step" data-step="step2">View &amp; Select Equipment</div><div class="step" data-step="saveprint">Save or Print Your Selections</div><div class="step" data-step="contact">Option: Send to a Summit Tractors Product Specialist to Discuss</div></div></nav>
<div class="controls no-print">
<label class="btn ghost" for="csvInput">Import CSV</label>
<input accept=".csv" id="csvInput" style="display:none" type="file"/>
<button class="ghost" id="shareBtn">Share</button>
</div>
</header>
<main>
<section class="screen welcome active" id="screen-welcome">
<div class="hero">
<h1>Welcome to the Summit Tractors Product Learning Center</h1>
<p class="muted">Explore Summit Tractors and compatible attachments, watch videos, view brochures and manuals, and save or send your configuration.</p>
<div style="margin-top:12px;"><button id="enterBtn" type="button">Enter</button></div>
</div>
<div class="welcome-product-grid"><h3 style="color:#254a4f;">Learn About These Tractors, Attachments &amp; Implements</h3><div class="welcome-grid"><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/Dump---Copy.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/SUMMIT-TX25HLX85BHX76.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/GRAPPLE-LOG-TIGHT---Copy.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/PALLET-FORKS.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/ROTARY-CUTTER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/FINISH-MOWER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/MIDDLE-BUSTER-SUB-SOILER-COMBO.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/MIDDLE-BUSTER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/SUBSOILER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/TILLER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/AFDHX60_BR.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/BOX-BLADE.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/Boxplane-2---Copy.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/LAND-PLANE.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/REAR-BLADE.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/LANDSCAPE-RAKE.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/SEEDER-SPREADER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/SNOW-PUSHER.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/SNOW-PUSHER-DRAG.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/BOOM-POLE.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/CARRY-ALL.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/QUICK-HITCH.png"/></figure><figure class="welcome-thumb"><img alt="" loading="lazy" src="https://summittractors.com/summitpics/TRAILER-MOVER.png"/></figure></div></div></section>
<section class="screen" id="screen-step2">
<h2>View &amp; Select Equipment</h2>
<div class="toolbar">
<div><span class="pill active" id="viewByProduct">By Product</span> <span class="pill" id="viewByApplication">By Application</span></div>
<div class="muted">Select any number. Use "Select All" to add all visible items.</div>
<div class="grow"></div>
<button id="selectAll" type="button">Select All</button>
<button class="secondary" id="removeAll" type="button">Remove All</button>
</div>
<div class="grid cols-3" id="attachmentsContainer"></div>
</section><section class="screen" id="screen-saveprint">
<h2>Save or Print Your Selections</h2>
<div class="print-summary" id="savePrintTarget"></div>
<div class="toolbar">
<button id="printBtn" type="button">Print</button>
<p class="muted">Tip: On mobile, choose “Save as PDF” to share a copy.</p>
<div id="savePrintTotal" style="margin-left:auto;font-weight:800"></div></div>
</section>
<section class="screen" id="screen-step3">
<h2>Step 3: Go to Learning Center</h2>
<p class="muted">Deep-dive into each product. View descriptions, key features, seasonal uses, watch videos, and open brochures or manuals within the app.</p>
<div class="grid cols-2" id="learningCards"></div>
<div class="sticky-actions no-print">
<button class="secondary" id="exportJSON" type="button">Download JSON</button>
<button class="secondary" id="exportCSV" type="button">Download CSV</button>
<button id="leadBtn" type="button">Send to Product Specialist</button>
</div>
</section>
<section class="screen" id="screen-contact-intro">
<h2>Talk with a Summit Tractors Product Specialist</h2>
<div class="card"><div class="body">
<h3>Why send your selections?</h3>
<ul class="kfeatures">
<li><strong>Expert guidance</strong> on best-fit tractor &amp; attachments for your jobs.</li>
<li><strong>Availability &amp; lead times</strong> at nearby Tractor Supply locations.</li>
<li><strong>Package pricing</strong> options and current promotions.</li>
</ul>
<h3>What happens next?</h3>
<ol class="kfeatures">
<li>We’ll receive your selected items and contact details.</li>
<li>A Product Specialist will reach out within <strong>1–2 business days</strong>.</li>
<li>You can ask questions, compare options, and plan next steps.</li>
</ol>
<div class="toolbar">
<button id="contactIntroProceed" type="button">Proceed</button>
<button class="secondary" id="contactIntroLater" type="button">Not Now</button>
</div>
</div></div>
</section>
<!-- BEGIN: Contact Benefit Interim Screen -->
<section class="screen" id="screen-contact">
<div class="card" style="max-width:920px;margin:2rem auto;padding:2rem;border:1px solid #eee;border-radius:16px;box-shadow:0 4px 18px rgba(0,0,0,0.06);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;">
<div style="display:flex;gap:1rem;align-items:center; margin-bottom:1rem;">
<img alt="Summit Tractors" height="auto" src="SUMMIT TRACTORS READY TO GO TO WORK LOGO - WHITE ON GREEN BACKGROUND.png" style="border-radius:8px;" width="120"/>
<div>
<div style="font-weight:700; font-size:1.25rem;">Talk with a Summit Tractors Product Specialist</div>
<div style="font-size:0.95rem;color:#555">We’ll review your selections and make sure you get the right configuration, pricing, and next steps.</div>
</div>
</div>
<ul style="margin:1rem 0 1.5rem 1.25rem; line-height:1.5; color:#333;">
<li>✅ Confirm fit &amp; compatibility for your use cases</li>
<li>✅ Get availability, delivery options, and current offers</li>
<li>✅ Receive a shareable summary of your build</li>
</ul>
<div style="display:flex; gap:0.75rem; flex-wrap:wrap;">
<button class="btn primary" id="contactBenefitProceed" style="padding:0.75rem 1rem; border:none; border-radius:10px; font-weight:600; cursor:pointer;">Proceed to Contact Form</button>
<button class="btn secondary" id="contactBenefitExit" style="padding:0.75rem 1rem; border:1px solid #254A4F; border-radius:10px; background:#fff; color:#254A4F; font-weight:600; cursor:pointer;">Cancel</button>
</div>
</div>
</section>
<!-- END: Contact Benefit Interim Screen -->
</main>
<div class="modal" id="modal">
<div class="dialog">
<header>
<div id="modalTitle">Viewer</div>
<button class="secondary" id="modalClose" type="button">Close</button>
</header>
<div class="content" id="modalContent"></div>
</div>
</div>
<div class="modal" id="leadModal">
<div class="dialog">
<header>
<div>Send to Summit Product Specialist</div>
<button class="secondary" id="leadClose" type="button">Close</button>
</header>
<div class="content">
<form class="grid cols-2" id="leadForm">
<div ""}"="" :="" class="card${sel ?" selected"=""><div class="body">
<label>First Name<br/><input id="firstName" required="" type="text"/></label>
</div></div>
<div ""}"="" :="" class="card${(state.tractors &amp;&amp; state.tractors.has(p.ProductID)) || (state.attachments &amp;&amp; state.attachments.has(p.ProductID)) ?" selected"=""><div class="body">
<label>Last Name<br/><input id="lastName" required="" type="text"/></label>
</div></div>
<div class="card"><div class="body">
<label>Email<br/><input id="email" placeholder="name@example.com" required="" type="email"/></label>
</div></div>
<div class="card"><div class="body">
<label>Phone<br/><input id="phone" placeholder="555-123-4567" required="" type="tel"/></label>
</div></div>
<div class="card"><div class="body">
<label>Preferred Contact Method<br/>
<select id="contactMethod">
<option>Email</option>
<option>Phone</option>
</select>
</label>
</div></div>
<div class="card"><div class="body">
<label>Preferred Times<br/>
<select id="contactTimes" multiple="" size="5">
<option>Weekdays</option>
<option>Weekends</option>
<option>Mornings</option>
<option>Afternoons</option>
<option>Evenings</option>
</select>
</label>
</div></div>
<div class="card" style="grid-column: 1/-1;"><div class="body">
<label>Comments (optional)<br/><textarea id="comments" rows="3"></textarea></label>
</div></div>
<div class="card"><div class="body">
<div id="captchaQ"></div>
<label>Your Answer<br/><input id="captchaA" required="" type="number"/></label>
</div></div>
<div class="card"><div class="body">
<label><input id="consent" required="" type="checkbox"/> I agree to be contacted by Summit Tractors.</label>
</div></div>
<div class="actions" style="grid-column: 1/-1; padding: 8px 0;">
<button type="submit">Prepare Submission</button>
<button class="secondary" id="leadCopy" type="button">Copy JSON</button>
<button class="secondary" id="leadDownload" type="button">Download JSON</button>
</div>
<div class="muted" id="leadStatus" style="grid-column: 1/-1;"></div>
</form>
</div>
</div>
</div>
<script>
    const RAW_DATA = [{"ProductID":"PI-TX25HLX85","Category":"Attachment & Implement","Application":"1- Tractors","Model":"TX25HLX85","ProductName":"Summit TX25H Tractor & Loader","SKU":"6014687","Price":"$19,499.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit TX25H compact tractor is a versatile, year-round workhorse designed to handle a wide range of tasks with ease. With the right attachments, it can mow, grade, haul, dig, till, and clear snow, delivering the power of a larger tractor in a smaller, more maneuverable package. This adaptability makes the TX25H a smart investment for property owners who want one machine that can do it all.","KeyFeatures":"24.7 HP Mitsubishi 3-Cyl. EPA Tier 4 Diesel Engine; 3rd Function Hydraulics - Grapple Ready; Rear Hydraulic Remotes; Self-Leveling SSQA Loader; Goodyear All-Condition R14T Tires; RimGuard Liquid Tire Ballast in the Rears; Premium Suspension Seat With Backrest Extension; Toolbox; Rear Work Light; Swinging Drawbar; Cross Drawbar; Front Tow hook","SeasonalUses-Spring":"The Summit TX25H Tractor is built to get your property ready for the season. In spring, it handles soil preparation with ease, whether you are tilling, cultivating, or discing gardens, fields, and food plots. Pair it with seeders and spreaders to make planting efficient, and use its loader and grading tools to clear branches, haul brush, and repair driveways after winter.","SeasonalUses-Summer":"Through the summer months, the Summit TX25H shines as a mowing and maintenance machine. Attach a rotary cutter for pastures, a finishing mower for lawns, or a flail mower for roadside and ditch upkeep. With pallet forks and loaders, it moves hay bales, feed, and supplies, while also tackling fencing projects, gravel spreading, light construction, and crop irrigation with sprayers or tanks.","SeasonalUses-Fall":"Summit TX25H Tractor & LX85 Loader supports harvest, cleanup, and drainage improvements.","SeasonalUses-Winter":"In winter, the Summit TX25H becomes a dependable snow and ice management solution. With front-end loaders, blades, pushers, or snow blowers, it clears driveways and access roads quickly and efficiently. It also manages livestock chores by moving feed and bedding, spreads salt or sand for ice control, and keeps your property accessible in all conditions.","ImageURLs":"https://summittractors.com/summitpics/Dump---Copy.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"1","Active":"TRUE"},{"ProductID":"PI-TX25HLX85BHX76","Category":"Attachment & Implement","Application":"1- Tractors","Model":"TX25HLX85BHX76","ProductName":"Summit TX25H Tractor & Loader & Backhoe","SKU":"6014686","Price":"$27,499.00 ","DescriptionShort":"Opening Description","DescriptionLong":"Pairing the Summit BHX76 Backhoe with the Summit TX25H transforms the tractor into a true digging and excavation machine. The backhoe makes it easy to handle jobs like trenching for utilities, planting trees, removing stumps, and clearing ditches, tasks a tractor alone cannot tackle. Together, they create a powerful, all-in-one solution for year-round property maintenance and improvement.","KeyFeatures":"All Features of the Summit TX25H Tractor & LX85 Loader; Mechanical Thumb to Lift Boulders; Logs and Other Material; Independent Operator Seat - No Need to Pivot the Tractor Seat Around; Standard 12\" Bucket; Optional 8\" & 16\" Buckets; Backhoe On/Off the Tractor in Minutes; Locking Pin Keepers so They Don't Get Lost; ISO SAE Operator Controls; Full Subframe Mount; SMV Sign for Transport Safety on the Road","SeasonalUses-Spring":"The Summit TX25H Tractor, paired with the Summit BHX76 Backhoe, makes spring work simple and efficient. Use the tractor for soil preparation like tilling, cultivating, and discing, then hook up seeders and spreaders to get planting underway. The BHX76 Backhoe is ideal for digging trenches for irrigation lines, planting trees, or removing stubborn stumps. Together, they handle property cleanup by clearing branches, hauling brush, and repairing driveways after winter.ields, gardens, and landscaping projects","SeasonalUses-Summer":"Through the summer months, the Summit TX25H takes care of mowing and pasture maintenance with rotary cutters, finishing mowers, or flail mowers. Its loader and forks move hay bales, feed, and building materials with ease. The Summit BHX76 Backhoe adds construction capability, making quick work of post hole digging, trenching for utilities, and small excavation projects around your property. With this combination, you can handle fencing, landscaping, and water system installations all season long.","SeasonalUses-Fall":"When fall arrives, the Summit TX25H supports harvest with the strength to pull wagons, haul produce, and power augers. It also preps land for winter with cover crop planting, fertilizing, and tilling residue back into the soil. The BHX76 Backhoe extends your reach by digging drainage ditches, clearing out culverts, and helping with tree planting or removal. Together, they simplify leaf cleanup, property maintenance, and firewood preparation, from hauling logs to splitting wood with a PTO-powered splitter.","SeasonalUses-Winter":"In winter, the Summit TX25H Tractor transforms into a dependable snow and ice management machine, using loaders, blades, pushers, or snow blowers to keep driveways and access roads clear. It also manages livestock chores by moving feed and bedding, and spreads sand or salt for ice control. With the Summit BHX76 Backhoe, you can dig out compacted snow piles, clear drainage areas, or handle utility repairs even in frozen ground. This pairing ensures your property stays productive and accessible all winter long.","ImageURLs":"https://summittractors.com/summitpics/SUMMIT-TX25HLX85BHX76.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"2","Active":"TRUE"},{"ProductID":"PI-GX54","Category":"Attachment & Implement","Application":"2 - Material Handling","Model":"GX54","ProductName":"Summit 54\" SSQA Grapple","SKU":"12345678","Price":"$2,499.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 54\" SSQA Grapple grips logs, brush, and debris securely, making land clearing and storm cleanup more efficient.","KeyFeatures":"High lift capacity; Secure grip; Works with logs and debris","SeasonalUses-Spring":"Use Summit 54\" SSQA Grapple to lift and stack limbs from storms and winter pruning.","SeasonalUses-Summer":"Summit 54\" SSQA Grapple moves logs, brush, and debris during landscaping and clearing.","SeasonalUses-Fall":"Load firewood and clean fence lines with Summit 54\" SSQA Grapple.","SeasonalUses-Winter":"Stage Summit 54\" SSQA Grapple for storm cleanup or move logs/firewood as needed.","ImageURLs":"https://summittractors.com/summitpics/GRAPPLE-LOG-TIGHT---Copy.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"3","Active":"TRUE"},{"ProductID":"PI-PFX42","Category":"Attachment & Implement","Application":"2 - Material Handling","Model":"PFX42","ProductName":"Summit 42\" SSQA Pallet Forks","SKU":"12345678","Price":"$1,199.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 42\" SSQA Pallet Forks lifts and transports pallets, feed, and materials, turning a compact tractor into a handy forklift.","KeyFeatures":"Move pallets; Adjustable spacing; Heavy-duty frame","SeasonalUses-Spring":"Unload mulch, soil, and building supplies with Summit 42\" SSQA Pallet Forks to start projects.","SeasonalUses-Summer":"Summit 42\" SSQA Pallet Forks moves pallets, feed, and materials around the property.","SeasonalUses-Fall":"Shift totes, firewood, and supplies with Summit 42\" SSQA Pallet Forks for winter prep.","SeasonalUses-Winter":"Use Summit 42\" SSQA Pallet Forks to handle salt, sand, or bundled materials in cold weather.","ImageURLs":"https://summittractors.com/summitpics/PALLET-FORKS.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"4","Active":"TRUE"},{"ProductID":"PI-RCX48","Category":"Attachment & Implement","Application":"3 - Mowing & Brush Cutting","Model":"RCX48","ProductName":"Summit 48\" Rotary Cutter","SKU":"12345678","Price":"$2,199.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 48\" Rotary Cutter is built to mow fields, pastures, and road edges, handling tall grass and brush with durable blades.","KeyFeatures":"Summit 48\" Rotary Cutter is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Start clearing overgrowth with Summit 48\" Rotary Cutter after wet conditions subside.","SeasonalUses-Summer":"Summit 48\" Rotary Cutter handles tall grass and brush along fields, trails, and fence lines.","SeasonalUses-Fall":"Cut back seasonal growth and tidy property edges with Summit 48\" Rotary Cutter.","SeasonalUses-Winter":"Inspect and store Summit 48\" Rotary Cutter; grease pivots and check driveline components.","ImageURLs":"https://summittractors.com/summitpics/ROTARY-CUTTER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"5","Active":"TRUE"},{"ProductID":"PI-FMX60","Category":"Attachment & Implement","Application":"3 - Mowing & Brush Cutting","Model":"FMX60","ProductName":"Summit 60\" 3-Point Finish Mower","SKU":"12345678","Price":"$2,500.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" 3-Point Finish Mower delivers a smooth, lawn quality cut across large turf areas, ideal for estates and grounds maintenance.","KeyFeatures":"Sharp cutting deck; Adjustable height; Durable construction","SeasonalUses-Spring":"Mount Summit 60\" 3-Point Finish Mower early to knock down fast-growing grass and restore lawns and acreage.","SeasonalUses-Summer":"Summit 60\" 3-Point Finish Mower maintains lawns, pastures, and road edges through peak growth.","SeasonalUses-Fall":"Use Summit 60\" 3-Point Finish Mower for final cuts and to mulch leaves before winter.","SeasonalUses-Winter":"Service and store Summit 60\" 3-Point Finish Mower; sharpen blades and check belts for the next season.","ImageURLs":"https://summittractors.com/summitpics/FINISH-MOWER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"6","Active":"TRUE"},{"ProductID":"PI-MBSSX1","Category":"Attachment & Implement","Application":"4 - Tillage & Soil Management","Model":"MBSSX1","ProductName":"Summit MBSSX1 Middle Buster-SubSoiler","SKU":"12345678","Price":"$329.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit MBSSX1 Middle Buster Sub-Soiler Combo breaks hardpan, improves drainage, and opens furrows for planting.","KeyFeatures":"Summit MBSSX1 Middle Buster Sub-Soiler Combo is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Apply seed and fertilizer precisely with Summit MBSSX1 Middle Buster Sub-Soiler Combo to jump-start growth.","SeasonalUses-Summer":"Summit MBSSX1 Middle Buster Sub-Soiler Combo shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.","SeasonalUses-Fall":"Overseed lawns or apply lime/fertilizer with Summit MBSSX1 Middle Buster Sub-Soiler Combo for strong spring emergence.","SeasonalUses-Winter":"Summit MBSSX1 Middle Buster Sub-Soiler Combo stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.","ImageURLs":"https://summittractors.com/summitpics/MIDDLE-BUSTER-SUB-SOILER-COMBO.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"7","Active":"TRUE"},{"ProductID":"PI-MBX1","Category":"Attachment & Implement","Application":"4 - Tillage & Soil Management","Model":"MBX1","ProductName":"Summit MBX1 Middle Buster","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit MBX1 Middle Buster breaks hardpan, improves drainage, and opens furrows for planting.","KeyFeatures":"Summit MBX1 Middle Buster is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Apply seed and fertilizer precisely with Summit MBX1 Middle Buster to jump-start growth.","SeasonalUses-Summer":"Summit MBX1 Middle Buster shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.","SeasonalUses-Fall":"Overseed lawns or apply lime/fertilizer with Summit MBX1 Middle Buster for strong spring emergence.","SeasonalUses-Winter":"Summit MBX1 Middle Buster stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.","ImageURLs":"https://summittractors.com/summitpics/MIDDLE-BUSTER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"8","Active":"TRUE"},{"ProductID":"PI-SSX1","Category":"Attachment & Implement","Application":"4 - Tillage & Soil Management","Model":"SSX1","ProductName":"Summit SSX1 Sub-Soiler","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit SSX1 Sub-Soiler is a compact tractor attachment designed to improve productivity for property maintenance and farm tasks.","KeyFeatures":"Summit SSX1 Sub-Soiler is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Apply seed and fertilizer precisely with Summit SSX1 Sub-Soiler to jump-start growth.","SeasonalUses-Summer":"Summit SSX1 Sub-Soiler shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.","SeasonalUses-Fall":"Overseed lawns or apply lime/fertilizer with Summit SSX1 Sub-Soiler for strong spring emergence.","SeasonalUses-Winter":"Summit SSX1 Sub-Soiler stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.","ImageURLs":"https://summittractors.com/summitpics/SUBSOILER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"9","Active":"TRUE"},{"ProductID":"PI-RTLRX48","Category":"Attachment & Implement","Application":"4 - Tillage & Soil Management","Model":"RTLRX48","ProductName":"Summit 48\" Rotary Tiller","SKU":"12345678","Price":"$2,699.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 48\" Rotary Tiller prepares soil for planting by breaking ground, mixing amendments, and cultivating gardens and plots.","KeyFeatures":"Strong tines; Soil preparation; Easy depth adjustment","SeasonalUses-Spring":"Prepare gardens and food plots with Summit 48\" Rotary Tillerâ€”break ground, mix amendments, and create seedbeds.","SeasonalUses-Summer":"Use Summit 48\" Rotary Tiller for mid-season cultivation and weed control where appropriate.","SeasonalUses-Fall":"Incorporate residues and prep beds for spring using Summit 48\" Rotary Tiller.","SeasonalUses-Winter":"Clean, grease, and store Summit 48\" Rotary Tiller under cover to prevent rust.","ImageURLs":"https://summittractors.com/summitpics/TILLER.png","VideoURL":"https://youtu.be/204zuxJHRhw?si=Ka8GfaE1CMcL66u9","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"10","Active":"TRUE"},{"ProductID":"PI-AFDHX60","Category":"Attachment & Implement","Application":"4 - Tillage & Soil Management","Model":"AFDHX60","ProductName":"Summit 60\" Angle Frame Disc Harrow","SKU":"12345678","Price":"$1,299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Angle Frame Disc Harrow breaks up soil clods and incorporates residue, prepping ground for planting or leveling.","KeyFeatures":"Strong tines; Soil preparation; Easy depth adjustment","SeasonalUses-Spring":"Prepare gardens and food plots with Summit 60\" Angle Frame Disc Harrowâ€”break ground, mix amendments, and create seedbeds.","SeasonalUses-Summer":"Use Summit 60\" Angle Frame Disc Harrow for mid-season cultivation and weed control where appropriate.","SeasonalUses-Fall":"Incorporate residues and prep beds for spring using Summit 60\" Angle Frame Disc Harrow.","SeasonalUses-Winter":"Clean, grease, and store Summit 60\" Angle Frame Disc Harrow under cover to prevent rust.","ImageURLs":"https://summittractors.com/summitpics/AFDHX60_BR.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"11","Active":"TRUE"},{"ProductID":"PI-BBX60","Category":"Attachment & Implement","Application":"5 - Grading & Landscaping","Model":"BBX60","ProductName":"Summit 60\" Box Blade","SKU":"12345678","Price":"$1,199.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Box Blade is designed for grading, leveling, and pulling material, equipped with scarifiers for tougher jobs.","KeyFeatures":"Levels surfaces; Robust steel; Easy to use","SeasonalUses-Spring":"Repair washouts and re-crown driveways with Summit 60\" Box Blade after winter weather.","SeasonalUses-Summer":"Summit 60\" Box Blade maintains lanes, pads, and work areas during dry months.","SeasonalUses-Fall":"Touch up grades and improve drainage paths with Summit 60\" Box Blade before freeze.","SeasonalUses-Winter":"Use Summit 60\" Box Blade for light snow windrows or to manage runoff when thawing.","ImageURLs":"https://summittractors.com/summitpics/BOX-BLADE.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"12","Active":"TRUE"},{"ProductID":"PI-BPX60","Category":"Attachment & Implement","Application":"5 - Grading & Landscaping","Model":"BPX60","ProductName":"Summit BPX60 BoxPlane","SKU":"12345678","Price":"$2,599.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit BPX60 BoxPlane is a compact tractor attachment designed to improve productivity for property maintenance and farm tasks.","KeyFeatures":"Levels surfaces; Robust steel; Easy to use","SeasonalUses-Spring":"Repair washouts and re-crown driveways with Summit BPX60 BoxPlane after winter weather.","SeasonalUses-Summer":"Summit BPX60 BoxPlane maintains lanes, pads, and work areas during dry months.","SeasonalUses-Fall":"Touch up grades and improve drainage paths with Summit BPX60 BoxPlane before freeze.","SeasonalUses-Winter":"Use Summit BPX60 BoxPlane for light snow windrows or to manage runoff when thawing.","ImageURLs":"https://summittractors.com/summitpics/Boxplane-2---Copy.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"13","Active":"TRUE"},{"ProductID":"PI-LPX60","Category":"Attachment & Implement","Application":"5 - Grading & Landscaping","Model":"LPX60","ProductName":"Summit 60\" Land Plane","SKU":"12345678","Price":"$1,299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Land Plane levels and smooths gravel driveways and surfaces, quickly removing ruts and washboards.","KeyFeatures":"Levels surfaces; Robust steel; Easy to use","SeasonalUses-Spring":"Repair washouts and re-crown driveways with Summit 60\" Land Plane after winter weather.","SeasonalUses-Summer":"Summit 60\" Land Plane maintains lanes, pads, and work areas during dry months.","SeasonalUses-Fall":"Touch up grades and improve drainage paths with Summit 60\" Land Plane before freeze.","SeasonalUses-Winter":"Use Summit 60\" Land Plane for light snow windrows or to manage runoff when thawing.","ImageURLs":"https://summittractors.com/summitpics/LAND-PLANE.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"14","Active":"TRUE"},{"ProductID":"PI-RBX60","Category":"Attachment & Implement","Application":"5 - Grading & Landscaping","Model":"RBX60","ProductName":"Summit 60\" Rear Blade","SKU":"12345678","Price":"$799.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Rear Blade is a versatile blade for driveways and ditches, capable of grading, crowning, and light snow removal.","KeyFeatures":"Levels surfaces; Robust steel; Easy to use","SeasonalUses-Spring":"Repair washouts and re-crown driveways with Summit 60\" Rear Blade after winter weather.","SeasonalUses-Summer":"Summit 60\" Rear Blade maintains lanes, pads, and work areas during dry months.","SeasonalUses-Fall":"Touch up grades and improve drainage paths with Summit 60\" Rear Blade before freeze.","SeasonalUses-Winter":"Use Summit 60\" Rear Blade for light snow windrows or to manage runoff when thawing.","ImageURLs":"https://summittractors.com/summitpics/REAR-BLADE.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"15","Active":"TRUE"},{"ProductID":"PI-LRX60","Category":"Attachment & Implement","Application":"5 - Grading & Landscaping","Model":"LRX60","ProductName":"Summit 60\" Landscape Rake","SKU":"12345678","Price":"$899.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Landscape Rake collects rocks and debris, smooths topsoil, and grooms gravel for a clean, finished look.","KeyFeatures":"Smooth raking; Durable tines; Easy attachment","SeasonalUses-Spring":"Rake out debris and prep beds and trails with Summit 60\" Landscape Rake.","SeasonalUses-Summer":"Summit 60\" Landscape Rake grooms gravel, trails, and grounds for a clean finish.","SeasonalUses-Fall":"Windrow leaves and surface debris with Summit 60\" Landscape Rake for quick cleanup.","SeasonalUses-Winter":"Store and service Summit 60\" Landscape Rake so itâ€™s ready for spring.","ImageURLs":"https://summittractors.com/summitpics/LANDSCAPE-RAKE.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"16","Active":"TRUE"},{"ProductID":"PI-SSX500","Category":"Attachment & Implement","Application":"6 - Seeding/spreading","Model":"SSX500","ProductName":"Summit SSX500 Seeder/Spreader","SKU":"12345678","Price":"$799.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit SSX500 Seeder/Spreader distributes seed, fertilizer, or lime evenly to promote uniform growth.","KeyFeatures":"Summit SSX500 Seeder/Spreader is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Apply seed and fertilizer precisely with Summit SSX500 Seeder/Spreader to jump-start growth.","SeasonalUses-Summer":"Summit SSX500 Seeder/Spreader shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.","SeasonalUses-Fall":"Overseed lawns or apply lime/fertilizer with Summit SSX500 Seeder/Spreader for strong spring emergence.","SeasonalUses-Winter":"Summit SSX500 Seeder/Spreader stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.","ImageURLs":"https://summittractors.com/summitpics/SEEDER-SPREADER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"17","Active":"TRUE"},{"ProductID":"PI-SPX60","Category":"Attachment & Implement","Application":"7 - Snow Management","Model":"SPX60","ProductName":"Summit 60\" Snow Pusher","SKU":"12345678","Price":"$799.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Snow Pusher is built for efficient snow clearing, pushing heavy accumulations from driveways and lots.","KeyFeatures":"Heavy-duty blade; Clears snow quickly; Built for winter use","SeasonalUses-Spring":"Use Summit 60\" Snow Pusher to push late-season slush and tidy piles; then rinse and store for next winter.","SeasonalUses-Summer":"Off-season care for Summit 60\" Snow Pusher: inspect wear parts, repaint as needed, and store out of weather.","SeasonalUses-Fall":"Stage Summit 60\" Snow Pusher for the first snowâ€”inspect edges, check hardware, and position it for quick deployment.","SeasonalUses-Winter":"Summit 60\" Snow Pusher is built for winterâ€”clear driveways and lots, push heavy snow, and keep access open when storms hit.","ImageURLs":"https://summittractors.com/summitpics/SNOW-PUSHER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"18","Active":"TRUE"},{"ProductID":"PI-SPX60DK","Category":"Attachment & Implement","Application":"7 - Snow Management","Model":"SPX60DK","ProductName":"Summit 60\" Snow Pusher w/Drag ","SKU":"12345678","Price":"$999.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit 60\" Snow Pusher Drag Kit is built for efficient snow clearing, pushing heavy accumulations from driveways and lots.","KeyFeatures":"Heavy-duty blade; Clears snow quickly; Built for winter use","SeasonalUses-Spring":"Use Summit 60\" Snow Pusher Drag Kit to push late-season slush and tidy piles; then rinse and store for next winter.","SeasonalUses-Summer":"Off-season care for Summit 60\" Snow Pusher Drag Kit: inspect wear parts, repaint as needed, and store out of weather.","SeasonalUses-Fall":"Stage Summit 60\" Snow Pusher Drag Kit for the first snowâ€”inspect edges, check hardware, and position it for quick deployment.","SeasonalUses-Winter":"Summit 60\" Snow Pusher Drag Kit is built for winterâ€”clear driveways and lots, push heavy snow, and keep access open when storms hit.","ImageURLs":"https://summittractors.com/summitpics/SNOW-PUSHER-DRAG.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"19","Active":"TRUE"},{"ProductID":"PI-BPX1","Category":"Attachment & Implement","Application":"8 - Specialty 3-Point","Model":"BPX1","ProductName":"Summit BPX1 Boom Pole","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit BPX1 Boom Pole lifts engines, materials, or supplies, extending tractor reach for loading and handling.","KeyFeatures":"Summit BPX1 Boom Pole is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Move planters, fencing, tools, and materials with Summit BPX1 Boom Pole to launch projects.","SeasonalUses-Summer":"Summit BPX1 Boom Pole hauls supplies and equipment where you need themâ€”fast.","SeasonalUses-Fall":"Use Summit BPX1 Boom Pole for firewood and harvest-season handling.","SeasonalUses-Winter":"Relocate bundled goods and keep supplies organized with Summit BPX1 Boom Pole.","ImageURLs":"https://summittractors.com/summitpics/BOOM-POLE.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"20","Active":"TRUE"},{"ProductID":"PI-CAX1","Category":"Attachment & Implement","Application":"8 - Specialty 3-Point","Model":"CAX1","ProductName":"Summit CAX1 Carry All","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit CAX1 Carry All carries tools, supplies, and firewood, making transport around the property simple.","KeyFeatures":"Summit CAX1 Carry All is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Move planters, fencing, tools, and materials with Summit CAX1 Carry All to launch projects.","SeasonalUses-Summer":"Summit CAX1 Carry All hauls supplies and equipment where you need themâ€”fast.","SeasonalUses-Fall":"Use Summit CAX1 Carry All for firewood and harvest-season handling.","SeasonalUses-Winter":"Relocate bundled goods and keep supplies organized with Summit CAX1 Carry All.","ImageURLs":"https://summittractors.com/summitpics/CARRY-ALL.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"21","Active":"TRUE"},{"ProductID":"PI-QHX1","Category":"Attachment & Implement","Application":"8 - Specialty 3-Point","Model":"QHX1","ProductName":"Summit QHX1 Quick Hitch","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit QHX1 Quick Hitch attachment makes maneuvering trailers and implements quick and precise.","KeyFeatures":"Summit QHX1 Quick Hitch is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Summit QHX1 Quick Hitch helps kick off the seasonâ€”setup, repairs, and soil prep so youâ€™re ready for busy months ahead.","SeasonalUses-Summer":"Summit QHX1 Quick Hitch shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.","SeasonalUses-Fall":"Summit QHX1 Quick Hitch supports cleanup and prepâ€”manage residue, move materials, and button things up before winter.","SeasonalUses-Winter":"Summit QHX1 Quick Hitch stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.","ImageURLs":"https://summittractors.com/summitpics/QUICK-HITCH.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"22","Active":"TRUE"},{"ProductID":"PI-TMX1","Category":"Attachment & Implement","Application":"8 - Specialty 3-Point","Model":"TMX1","ProductName":"Summit TMX1 Trailer Mover","SKU":"12345678","Price":"$299.00 ","DescriptionShort":"Opening Description","DescriptionLong":"The Summit TMX1 Trailer Mover attachment makes maneuvering trailers and implements quick and precise.","KeyFeatures":"Summit TMX1 Trailer Mover is durable; Easy to use; Reliable performance","SeasonalUses-Spring":"Move planters, fencing, tools, and materials with Summit TMX1 Trailer Mover to launch projects.","SeasonalUses-Summer":"Summit TMX1 Trailer Mover hauls supplies and equipment where you need themâ€”fast.","SeasonalUses-Fall":"Use Summit TMX1 Trailer Mover for firewood and harvest-season handling.","SeasonalUses-Winter":"Relocate bundled goods and keep supplies organized with Summit TMX1 Trailer Mover.","ImageURLs":"https://summittractors.com/summitpics/TRAILER-MOVER.png","VideoURL":"https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC","BrochureURL":"https://summittractors.com/8.5x11-brochure-3.24.25.pdf","ManualURL":"https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf","SortOrder":"23","Active":"TRUE"}];

    const state = {
      data: [],
      tractor: null,
      attachments: new Set(),
      viewMode: 'product',
      currentTractorIndex: 0
    };

    const el = (sel, root=document) => root.querySelector(sel);
    const els = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const byCategory = (cat) => state.data.filter(d => (d.Category||'').trim() === cat && (d.Active||'').toUpperCase()==='TRUE');
    const toList = (s) => (s||'').split('|').map(x=>x.trim()).filter(Boolean);
    const fmt = (s) => (s||'').trim();

    function setActiveStep(id) {
      els('.screen').forEach(sc => sc.classList.remove('active'));
      const target = el('#screen-' + id);
      if (target) target.classList.add('active');
      els('.step').forEach(st => {
        st.classList.toggle('active', st.dataset && st.dataset.step === id);
      });
      window.scrollTo(0,0);
    }

    const titleCase = (s) => s.replace(/\s+/g,' ').trim().toLowerCase().replace(/(^|[\s\-\'])\S/g, t => t.toUpperCase());

    function decodeConfigFromURL() {
      try {
        const u = new URL(window.location.href);
        const cfg = u.searchParams.get('cfg');
        if (!cfg) return;
        const obj = JSON.parse(atob(cfg));
        if (Array.isArray(obj.tractors)) { state.tractors = new Set(obj.tractors); } else if (obj.tractor) { state.tractors = new Set([obj.tractor]); }
        if (Array.isArray(obj.attachments)) state.attachments = new Set(obj.attachments);
      } catch(e) { console.warn('No config in URL'); }
    }

    function encodeConfigToURL() {
      const obj = { tractors: Array.from(state.tractors || new Set()), attachments: Array.from(state.attachments) };
      const cfg = btoa(JSON.stringify(obj));
      const u = new URL(window.location.href);
      u.searchParams.set('cfg', cfg);
      navigator.clipboard.writeText(u.toString()).then(()=> alert('Shareable URL copied!')).catch(()=> alert('Copy failed, URL: ' + u.toString()));
    }

    function init() {
      // Hide overlay when ready
      const ov = el('#overlay'); if (ov) ov.style.display = 'none';

      state.data = RAW_DATA;
      decodeConfigFromURL();
      bindGlobalHandlers();
      renderTractorCarousel();
      renderAttachments();
      renderLearningCenter();
      setActiveStep('welcome');
    }

    function bindGlobalHandlers() {

      // --- Contact Benefit interim buttons ---
      try {
        const cbProceed = document.getElementById('contactBenefitProceed');
        if (cbProceed) cbProceed.addEventListener('click', function () {
          try { openLeadForm(); } catch (e) { console.warn('openLeadForm error:', e); setActiveStep('contact-intro'); }
        });
        const cbExit = document.getElementById('contactBenefitExit');
        if (cbExit) cbExit.addEventListener('click', function () {
          try { setActiveStep('step2'); } catch (e) { console.warn('setActiveStep error:', e); }
        });
      } catch (e) { console.warn('Contact Benefit handlers error:', e); }

      // --- Contact Intro screen buttons ---
      try {
        const introProceed = document.getElementById('contactIntroProceed');
        if (introProceed) introProceed.addEventListener('click', function () {
          try { openLeadForm(); } catch (e) { console.warn('setActiveStep error:', e); }
        });
        const introLater = document.getElementById('contactIntroLater');
        if (introLater) introLater.addEventListener('click', function () {
          try { setActiveStep('step2'); } catch (e) { console.warn('setActiveStep error:', e); }
        });
      } catch (e) { console.warn('Contact Intro handlers error:', e); }

// Contact step -> show intro screen first
els('.step[data-step="contact"]').forEach(function(st){
  st.addEventListener('click', function(){
    try { setActiveStep('contact-intro'); } catch(e){}
  });
});



// Auto-open PDF when Save/Print is clicked
els('.step[data-step="saveprint"]').forEach(function(st){
  st.addEventListener('click', function(){
    try { setActiveStep('saveprint'); } catch(e) {}
    if (typeof printSelectionsPDF === 'function') { openSavePrintInline(); }
  });
});



// Auto-open PDF when Save/Print menu item is pressed
els('.step').forEach(function(st){
  st.addEventListener('click', function(){
    var step = st.dataset.step;
    if (step === 'saveprint') {
      try { setActiveStep(step); } catch(e) {}
      openSavePrintInline();
    }
  });
});


      // Steps
      els('.step').forEach(st => st.addEventListener('click', () => setActiveStep(st.dataset.step)));
      const enter = el('#enterBtn');
      if (enter) {
        enter.addEventListener('click', () => setActiveStep('step2'));
        enter.addEventListener('keyup', (e) => { if (e.key === 'Enter' || e.keyCode === 13) setActiveStep('step2'); });
      }
      // Delegation fallback in case button is re-rendered
      document.addEventListener('click', (e) => {
        if (e.target && e.target.id === 'enterBtn') { setActiveStep('step2'); }
      });

      const btn2 = el('#toStep2'); if (btn2) btn2.addEventListener('click', () => setActiveStep('step2'));
      const btn3 = el('#toStep3'); if (btn3) btn3.addEventListener('click', () => setActiveStep('step2'));
      const share = el('#shareBtn'); if (share) share.addEventListener('click', encodeConfigToURL);
      if (csvInput) csvInput.addEventListener('change', handleCSVImport);
      const vbp = el('#viewByProduct'); if (vbp) vbp.addEventListener('click', () => { state.viewMode='product'; renderAttachments(); });
      const vba = el('#viewByApplication'); if (vba) vba.addEventListener('click', () => { state.viewMode='application'; renderAttachments(); });
      const all = el('#selectAll'); if (all) all.addEventListener('click', () => { byCategory('Attachment & Implement').forEach(i=> state.attachments.add(i.ProductID)); renderAttachments(); renderLearningCenter(); });
      const rem = el('#removeAll'); if (rem) rem.addEventListener('click', () => { state.attachments.clear(); renderAttachments(); renderLearningCenter(); });
      const lead = el('#leadBtn'); if (lead) lead.addEventListener('click', openLeadForm);
      const lc = el('#leadClose'); if (lc) lc.addEventListener('click', ()=> el('#leadModal').style.display='none');
      const mc = el('#modalClose'); if (mc) mc.addEventListener('click', ()=> el('#modal').style.display='none');
    }

    
function buildDetailCard(p) {
  const imgs = getImages(p);
  const main = imgs[0] || '';
  const feats = (p.KeyFeatures ? p.KeyFeatures.split(';').map(f => f.trim()).filter(Boolean) : []);
  return `
    <div class="card">
      <div class="media" data-main="${main}">${main ? `<img src="${main}" alt="${p.ProductName}"/>` : '<div class="muted">No image</div>'}</div>
      <div class="body">
        <h3>${p.ProductName}</h3>
        <div class="muted">Model: ${p.Model} &nbsp; | &nbsp; SKU: ${p.SKU} &nbsp; | &nbsp; Price: ${p.Price}</div>
        <div class="thumbs">
          ${imgs.map((u,i)=> `<img data-swap="${u}" class="${i===0?'active':''}" src="${u}" alt="thumb"/>`).join('')}
        </div>
        <h4>Key Features</h4><div class="kbadges">${feats.slice(0,5).map(f=> `<span class="kbadge">${f}</span>`).join('')}
        </div>
        <h4>Detailed Description</h4><p style="margin-top:8px;">${p.DescriptionLong || ''}</p>
        <div class="actions"><button class="secondary" type="button" data-modal="seasonal-uses" data-id="${p.ProductID}">Seasonal Uses</button> 
          ${p.VideoURL ? `<button class="secondary" data-video="${p.ProductID}" type="button">Watch Video</button>`: ''}
          ${p.BrochureURL ? `<button class="secondary" data-brochure="${p.ProductID}" type="button">View Brochure</button>`: ''}
          ${p.ManualURL ? `<button class="secondary" data-manual="${p.ProductID}" type="button">View Manual</button>`: ''}
        </div>
      </div>
    </div>`;
}

function renderTractorCarousel() {
      const container = el('#tractorCarousel');
      const tractors = sortByOrder(byCategory('Tractor'));
      if (!container) return;
      if (!tractors.length) { container.innerHTML = '<div class="muted">No tractors found.</div>'; return; }
      if (!state.tractor) state.tractor = tractors[0].ProductID;
      const selectedIndex = tractors.findIndex(t => t.ProductID===state.tractor);
      state.currentTractorIndex = selectedIndex>=0 ? selectedIndex : 0;

      function cardHTML(t)
{
        const imgs = getImages(t);
        const sel = (state.tractors && state.tractors.has(t.ProductID));
        const base = buildDetailCard(t);
        const extras = `
          <button id="selectTractorBtn" type="button">${sel ? "Remove" : "Select Tractor"}</button>
          <button class="secondary" id="nextToStep2" type="button">Go to Attachments & Implements</button>
        `;
        return base.replace('<div class="actions">', `<div class="actions">${extras}`);
      }

      function render() {
        const i = state.currentTractorIndex;
        const t = tractors[i];
        container.innerHTML = `
          <button id="prevT" class="secondary" type="button">‹</button>
          ${cardHTML(t)}
          <button id="nextT" class="secondary" type="button">›</button>
        `;
        el('#prevT').onclick = () => { state.currentTractorIndex = (state.currentTractorIndex - 1 + tractors.length) % tractors.length; render(); };
        el('#nextT').onclick = () => { state.currentTractorIndex = (state.currentTractorIndex + 1) % tractors.length; render(); };
        el('#selectTractorBtn').onclick = () => { if (!state.tractors) state.tractors = new Set();
      if (state.tractors.has(t.ProductID)) { state.tractors.delete(t.ProductID); showToast('Removed: ' + t.ProductName); }
      else { state.tractors.add(t.ProductID); showToast('Selected: ' + t.ProductName); }
      state.tractor = Array.from(state.tractors)[0] || null; renderLearningCenter(); 
  renderTractorCarousel(); };
        el('#nextToStep2').onclick = () => setActiveStep('step2');
      }
      render();
    }

    function renderAttachments() {
  const container =
    document.getElementById('attachmentsContainer') ||
    document.getElementById('attachmentsGrid') ||
    document.querySelector('[data-role="attachments-grid"]');
  if (!container) { console.warn('Attachments grid container not found.'); return; }

  // Prefer original sourcing if available; else fall back to generic arrays
  let items = [];
  if (typeof sortByOrder === 'function' && typeof byCategory === 'function') {
    try { items = sortByOrder(byCategory('Attachment & Implement')) || []; } catch(_){}
  }
  if (!items.length) {
    try {
      const src = (state && Array.isArray(state.products) && state.products.length ? state.products : null)
               || (Array.isArray(products) && products.length ? products : []);
      items = src || [];
    } catch(_) { items = []; }
  }

  if (!items || !items.length) {
    container.innerHTML = `<div class="muted" style="padding:12px">No products to display.</div>`;
    return;
  }

  const vbp = el('#viewByProduct'); if (vbp) vbp.classList.toggle('active', state.viewMode==='product');
  const vba = el('#viewByApplication'); if (vba) vba.classList.toggle('active', state.viewMode==='application');

  function card(it){ return buildSummaryCard(it); }

  if (state.viewMode === 'product') {
    container.innerHTML = items
      .slice()
      .sort((a,b)=> (a.ProductName||'').localeCompare(b.ProductName||''))
      .map(card).join('');
  } else {
    // If app groups by Application, keep simple render to avoid breaking layout
    container.innerHTML = items.map(card).join('');
  }

  // Wire handlers
  els('[data-add]').forEach(b => b.onclick = () => {
    const id = b.getAttribute('data-add');
    if (state.attachments && state.attachments.has && state.attachments.has(id)) state.attachments.delete(id);
    else if (state.attachments && state.attachments.add) state.attachments.add(id);
    if (typeof renderAttachments==='function') renderAttachments();
    if (typeof renderLearningCenter==='function') renderLearningCenter();
  });

  els('[data-preview]').forEach(b => b.onclick = () => {
    const id = b.getAttribute('data-preview');
    if (typeof openProductModal==='function') openProductModal(id);
    else if (typeof openDetailModal==='function') openDetailModal(id);
  });

  els('[data-details],[data-toggle-details]').forEach(b => {
    const id = b.getAttribute('data-details') || b.getAttribute('data-toggle-details');
    b.onclick = () => openDetailModal(id);
  });

  const all = el('#selectAll'); if (all) all.addEventListener('click', () => {
    items.forEach(i => state.attachments.add(i.ProductID));
    if (typeof renderAttachments==='function') renderAttachments();
    if (typeof renderLearningCenter==='function') renderLearningCenter();
  });
  const rem = el('#removeAll'); if (rem) rem.addEventListener('click', () => {
    state.attachments.clear();
    if (typeof renderAttachments==='function') renderAttachments();
    if (typeof renderLearningCenter==='function') renderLearningCenter();
  });
  const lead = el('#leadBtn'); if (lead) lead.addEventListener('click', openLeadForm);
  const lc = el('#leadClose'); if (lc) lc.addEventListener('click', ()=> el('#leadModal').style.display='none');
}

    function renderLearningCenter() {
      const container = el('#learningCards');
      if (!container) return;
      const selected = [];
      if (state.tractors && state.tractors.size) { state.tractors.forEach(id => selected.push(state.data.find(d => d.ProductID===id))); }
      state.attachments.forEach(id => selected.push(state.data.find(d=> d.ProductID===id)));
      container.innerHTML = selected.filter(Boolean).map(buildDetailCard).join('') || '<div class="muted">No products selected yet.</div>';

      function detailCard(p) {
        const imgs = getImages(p);
        const main = imgs[0] || '';
        const feats = (p.KeyFeatures ? p.KeyFeatures.split(';').map(f => f.trim()).filter(Boolean) : []);
        return `
          <div class="card">
            <div class="media" data-main="${main}">${main ? `<img src="${main}" alt="${p.ProductName}"/>` : '<div class="muted">No image</div>'}</div>
            <div class="body">
              <h3>${p.ProductName}</h3>
              <div class="muted">Model: ${p.Model} &nbsp; | &nbsp; SKU: ${p.SKU} &nbsp; | &nbsp; Price: ${p.Price}</div>
              <div class="thumbs">
                ${imgs.map((u,i)=> `<img data-swap="${u}" class="${i===0?'active':''}" src="${u}" alt="thumb"/>`).join('')}
              </div>
              <h4>Key Features</h4><div class="kbadges">${feats.slice(0,5).map(f=> `<span class="kbadge">${f}</span>`).join('')}
              </div>
              <h4>Detailed Description</h4><p style="margin-top:8px;">${p.DescriptionLong || ''}</p>
              <div class="actions"><button class="secondary" type="button" data-action="seasonal-uses" data-id="${p.ProductID}">Seasonal Uses</button> 
                ${p.VideoURL ? `<button class="secondary" data-video="${p.ProductID}" type="button">Watch Video</button>`: ''}
                ${p.BrochureURL ? `<button class="secondary" data-brochure="${p.ProductID}" type="button">View Brochure</button>`: ''}
                ${p.ManualURL ? `<button class="secondary" data-manual="${p.ProductID}" type="button">View Manual</button>`: ''}
              </div>
            </div>
          </div>`;
      }
      els('.thumbs img', container).forEach(img => img.onclick = () => {
        const url = img.getAttribute('data-swap');
        const media = img.closest('.card').querySelector('.media');
        media.innerHTML = url ? `<img src="${url}" alt="image"/>` : '<div class="muted">No image</div>';
        img.closest('.thumbs').querySelectorAll('img').forEach(t=> t.classList.remove('active'));
        img.classList.add('active');
      });
      els('[data-video]', container).forEach(b => b.onclick = () => openViewer('Video', getProd(b.dataset.video).VideoURL));
      els('[data-brochure]', container).forEach(b => b.onclick = () => openViewer('Brochure', getProd(b.dataset.brochure).BrochureURL));
      els('[data-manual]', container).forEach(b => b.onclick = () => openViewer('Manual', getProd(b.dataset.manual).ManualURL));
      const exj = el('#exportJSON'); if (exj) exj.onclick = downloadJSON;
      const exc = el('#exportCSV'); if (exc) exc.onclick = downloadCSV;
    }

    function getProd(id) { return state.data.find(d => d.ProductID===id); }

    function openProductModal(id) {
      const p = getProd(id);
      const imgs = getImages(p);
      const main = imgs[0] || '';
      el('#modalTitle').textContent = p.ProductName;
      el('#modalContent').innerHTML = `
        <div class="media">${main ? `<img src="${main}" alt="${p.ProductName}"/>` : '<div class="muted">No image</div>'}</div>
        <div style="padding:8px 0;">
          <div class="muted">Model: ${p.Model} &nbsp; | &nbsp; SKU: ${p.SKU} &nbsp; | &nbsp; Price: ${p.Price}</div>
          <p>${p.DescriptionLong || ''}</p>
        </div>`;
      el('#modal').style.display='flex';
    }

    function openViewer(title, url) {
      el('#modalTitle').textContent = title;
      const isYT = /youtube\.com|youtu\.be/.test(url||'');
      const isMP4 = /\.mp4($|\?)/i.test(url||'');
      if (isYT) {
        el('#modalContent').innerHTML = `<div style="position:relative;padding-top:56.25%;"><iframe src="${url}" allow="autoplay; encrypted-media" allowfullscreen style="position:absolute;inset:0;width:100%;height:100%;border:0;"></iframe></div>`;
      } else if (isMP4) {
        el('#modalContent').innerHTML = `<video src="${url}" controls style="width:100%;max-height:70vh;"></video>`;
      } else {
        el('#modalContent').innerHTML = `<iframe src="${url}" style="width:100%;height:70vh;border:0;"></iframe>`;
      }
      el('#modal').style.display='flex';
    }

    function selectedProducts() {
      const out = [];
      if (state.tractors && state.tractors.size) { Array.from(state.tractors).forEach(id => out.push(getProd(id))); }
      state.attachments.forEach(id => out.push(getProd(id)));
      return out.filter(Boolean);
    }

    function downloadJSON() {
      const data = selectedProducts().map(p => ({ ProductID:p.ProductID, ProductName:p.ProductName, Model:p.Model, SKU:p.SKU, Price:p.Price, Image:(getImages(p)[0]||'') }));
      const blob = new Blob([JSON.stringify({ selections:data }, null, 2)], {type:'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'summit_plc_selections.json'; a.click();
    }

    function downloadCSV() {
      const cols = ['ProductID','ProductName','Model','SKU','Price'];
      const rows = selectedProducts().map(p => cols.map(c=> (p[c]||'').toString().replace(/\n/g,' ').replace(/"/g,'""')));
      const header = cols.join(',');
      const body = rows.map(r => r.map(v => /[",\n]/.test(v) ? `"${v}"` : v).join(',')).join('\n');
      const csv = header + '\n' + body;
      const blob = new Blob([csv], {type:'text/csv'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'summit_plc_selections.csv'; a.click();
    }

    function openLeadForm() {
      const a = Math.floor(Math.random()*9)+1, b = Math.floor(Math.random()*9)+1;
      el('#captchaQ').textContent = `Captcha: What is ${a} + ${b}?`;
      el('#captchaQ').dataset.answer = (a+b);
      el('#leadStatus').textContent = '';
      el('#leadModal').style.display='flex';
      el('#leadCopy').onclick = copyLeadJSON;
      el('#leadDownload').onclick = downloadLeadJSON;
      el('#leadForm').onsubmit = prepareLead;
    }

    function normalizePhone(num) {
      const digits = (num||'').replace(/\D/g,'');
      let d = digits;
      if (d.length===11 && d.startsWith('1')) d = d.slice(1);
      if (d.length!==10) return null;
      if (/^[01]/.test(d[0]) || /^[01]/.test(d[3])) return null;
      return d.slice(0,3)+'-'+d.slice(3,6)+'-'+d.slice(6);
    }

    function prepareLead(ev) {
      ev.preventDefault();
      const email = (el('#email').value||'').trim();
      const first = titleCase(el('#firstName').value);
      const last  = titleCase(el('#lastName').value);
      const phone = normalizePhone(el('#phone').value);
      const times = Array.from(el('#contactTimes').selectedOptions).map(o=>o.value);
      const method = el('#contactMethod').value;
      const comments = (el('#comments').value||'').trim();
      const captchaOK = parseInt(el('#captchaA').value,10) === parseInt(el('#captchaQ').dataset.answer,10);
      const consent = el('#consent').checked;

      const emailOK = /^(?=.{3,254}$)[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,63}$/i.test(email);
      if (!emailOK) return alert('Please enter a valid email address.');
      if (!phone) return alert('Please enter a valid 10-digit US/CA phone.');
      if (!captchaOK) return alert('Captcha incorrect.');
      if (!consent) return alert('Consent is required.');

      const payload = {
        firstName: first,
        lastName: last,
        email,
        phone,
        company: 'Summit PLC Visitor',
        preferredContactMethod: method,
        preferredContactTimes: times,
        comments,
        selectedConfiguration: selectedProducts().map(p => ({ productId: p.ProductID, name: p.ProductName, sku: p.SKU })),
        leadSource: 'Product Learning Center App'
      };
      el('#leadStatus').textContent = 'Submission prepared. You can copy or download the JSON now. (Wire your Salesforce Web-to-Lead endpoint to POST this payload.)';
      el('#leadStatus').dataset.payload = JSON.stringify(payload, null, 2);
    }

    function copyLeadJSON() {
      const data = el('#leadStatus').dataset.payload || JSON.stringify({error:'Nothing prepared yet'}, null, 2);
      navigator.clipboard.writeText(data).then(()=> alert('Lead JSON copied')).catch(()=> alert('Copy failed'));
    }
    function downloadLeadJSON() {
      const text = el('#leadStatus').dataset.payload || JSON.stringify({error:'Nothing prepared yet'}, null, 2);
      const blob = new Blob([text], {type:'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'summit_plc_lead.json'; a.click();
    }

    function handleCSVImport(e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        const text = reader.result;
        const parsed = parseCSV(text);
        if (!parsed.rows.length) return alert('No rows found in CSV');
        state.data = parsed.rows;
        state.tractors = new Set();
        state.attachments = new Set();
        renderTractorCarousel();
        renderAttachments();
        renderLearningCenter();
        alert('CSV imported successfully.');
      };
      reader.readAsText(file);
    }

    function parseCSV(text) {
      const lines = text.split(/\r?\n/).filter(l => l.trim()!=='');
      if (!lines.length) return { header:[], rows:[] };
      const header = splitLine(lines[0]);
      const rows = lines.slice(1).map(line => {
        const cols = splitLine(line);
        const obj = Object.fromEntries(header.map((h,i)=> [h, (cols[i]||'').trim()]));
        return obj;
      });
      return { header, rows };
    }
    function splitLine(line) {
      const out = []; let cur = ''; let inQ = false;
      for (let i=0;i<line.length;i++) {
        const ch = line[i];
        if (ch === '"' && line[i+1] === '"') { cur += '"'; i++; continue; }
        if (ch === '"') { inQ = !inQ; continue; }
        if (ch === ',' && !inQ) { out.push(cur); cur=''; continue; }
        cur += ch;
      }
      out.push(cur);
      return out;
    }

    window.addEventListener('DOMContentLoaded', init);
  
// --- Sorting helpers (by SortOrder then ProductName) ---
function __num(v){ const n = parseInt(String(v||'').trim(), 10); return isNaN(n) ? Number.POSITIVE_INFINITY : n; }
function sortByOrder(arr){
  return [...arr].sort((a,b) => __num(a.SortOrder) - __num(b.SortOrder) || String(a.ProductName||'').localeCompare(String(b.ProductName||'')));
}

</script>
<div aria-live="polite" class="toast" id="toast" role="status"></div>
<script>
  function showToast(msg){
    const t = document.querySelector('#toast');
    if(!t){ alert(msg); return; }
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(window.__toastTimer);
    window.__toastTimer = setTimeout(()=> t.classList.remove('show'), 1800);
  }
</script>
<script>
window.addEventListener('load', function(){
  const ov = document.querySelector('#overlay'); if (ov) ov.style.display = 'none';
});
</script>
<script>
  // --- Safe video/embed override: does not rely on replacing existing functions ---
  (function(){
    function isYouTubeUrl(url){
      try {
        const u = new URL(url);
        return /(^|\.)youtube\.com$/.test(u.hostname) || /(^|\.)youtu\.be$/.test(u.hostname);
      } catch { return false; }
    }
    function toYouTubeEmbed(url){
      try {
        const u = new URL(url);
        let id = '';
        if (u.hostname.includes('youtu.be')) {
          id = u.pathname.replace(/^\/+/, '');
        } else if (u.pathname.startsWith('/shorts/')) {
          id = u.pathname.split('/')[2] || '';
        } else {
          id = u.searchParams.get('v') || '';
        }
        if (!id) return null;
        const params = new URLSearchParams({ rel:'0', modestbranding:'1', playsinline:'1' });
        return `https://www.youtube.com/embed/${id}?${params.toString()}`;
      } catch { return null; }
    }

    window.openViewer = function(title, url){
      const modal = document.getElementById('modal');
      const titleEl = document.getElementById('modalTitle');
      const content = document.getElementById('modalContent');
      titleEl.textContent = title;

      const isYT = isYouTubeUrl(url);
      const isMP4 = /\.mp4($|\?)/i.test(url||'');

      if (isYT) {
        const embed = toYouTubeEmbed(url);
        const iframeSrc = embed || url;
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <div style="position:relative;padding-top:56.25%;">
            <iframe
              src="${iframeSrc}"
              title="Video player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen
              style="position:absolute;inset:0;width:100%;height:100%;border:0;"
            ></iframe>
          </div>`;
      } else if (isMP4) {
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <video src="${url}" controls playsinline style="width:100%;max-height:70vh;"></video>`;
      } else {
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <iframe src="${url}" style="width:100%;height:70vh;border:0;"></iframe>`;
      }

      const closeBtn = content.querySelector('.player-close');
      if (closeBtn) closeBtn.onclick = () => { modal.style.display = 'none'; };

      modal.style.display = 'flex';
      const escHandler = (e) => { if (e.key === 'Escape') { modal.style.display='none'; document.removeEventListener('keydown', escHandler); } };
      document.addEventListener('keydown', escHandler, { once: true });
    };
  })();
</script>
<script>
  (function(){
    // Ensure state exists
    if (window.state) {
      if (!state.tractors) state.tractors = new Set();
      if (state.tractor && !state.tractors.size) { state.tractors.add(state.tractor); }
      // Keep legacy state.tractor in sync for any remaining code paths expecting a single value
      if (!state.tractor && state.tractors.size) state.tractor = Array.from(state.tractors)[0];
    }

    // Helper to check selected in templates that used (state.tractor===t.ProductID)
    window.isTractorSelected = function(id){
      return !!(window.state && state.tractors && state.tractors.has(id));
    };
  })();
</script>
<script>
  (function(){
    // Ensure any PDF/iframe viewers get an inline Close button even if opened by legacy code
    const modal = document.getElementById('modal');
    const content = document.getElementById('modalContent');
    if (!modal || !content) return;

    function ensureInlineClose(){
      // If there's already an inline button, skip
      if (content.querySelector('.player-close')) return;
      // If there is an iframe or object (PDF) or video, add the button at the top
      const hasViewer = content.querySelector('iframe,object,embed,video');
      if (!hasViewer) return;

      const btn = document.createElement('button');
      btn.className = 'player-close';
      btn.type = 'button';
      btn.setAttribute('aria-label','Close');
      btn.textContent = '×';
      btn.addEventListener('click', () => {
        if (typeof window.stopViewer === 'function') window.stopViewer();
        modal.style.display = 'none';
      });
      // Ensure positioning context
      content.style.position = content.style.position || 'relative';
      content.prepend(btn);
    }

    const obs = new MutationObserver(() => {
      if (modal.style.display !== 'none' && modal.style.display !== '') {
        ensureInlineClose();
      }
    });

    obs.observe(content, { childList: true, subtree: true });
    // Also run when modal opens
    const openObs = new MutationObserver(() => {
      if (modal.style.display !== 'none' && modal.style.display !== '') {
        ensureInlineClose();
      }
    });
    openObs.observe(modal, { attributes: true, attributeFilter:['style'] });
  })();
</script>
<script>
  (function(){
    function ensureArray(x){
      if (!x) return [];
      if (Array.isArray(x)) return x.filter(Boolean).map(s => String(s).trim()).filter(Boolean);
      // split on common delimiters: newline, semicolon, comma, pipe
      return String(x).split(/\r?\n|[;,|]/).map(s => s.trim()).filter(Boolean);
    }

    function getSeasonalUses(prod){
      if (!prod) return [];
      // Try a set of likely column names from the CSV
      const candidates = [
        prod.SeasonalUses, prod.SeasonalUse, prod.Seasonality,
        prod.Season_Uses, prod.Season_Use, prod.SeasonUses, prod.SeasonUse
      ];
      for (const c of candidates){
        const arr = ensureArray(c);
        if (arr.length) return arr;
      }
      return [];
    }

    function openSeasonalUses(prod){
      const modal = document.getElementById('modal');
      const titleEl = document.getElementById('modalTitle');
      const content = document.getElementById('modalContent');
      const uses = getSeasonalUses(prod);
      titleEl.textContent = (prod?.ProductName || 'Seasonal Use');

      if (!uses.length){
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <div style="padding:12px;">
            <p>No seasonal uses are listed for this product.</p>
          </div>`;
      } else {
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <div style="padding:12px;">
            <h3 style="margin-top:0;">Seasonal Uses</h3>
            <ul style="margin:8px 0 0 18px; line-height:1.5;">
              ${uses.map(u => `<li>${u}</li>`).join('')}
            </ul>
          </div>`;
      }

      const closeBtn = content.querySelector('.player-close');
      if (closeBtn) closeBtn.onclick = () => { content.innerHTML = ''; modal.style.display = 'none'; };

      modal.style.display = 'flex';
      const escHandler = (e) => { if (e.key === 'Escape') { content.innerHTML=''; modal.style.display='none'; document.removeEventListener('keydown', escHandler); } };
      document.addEventListener('keydown', escHandler, { once: true });
    }

    // Delegate click for any Seasonal Use button within dynamic cards
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-action="seasonal-uses"]');
      if (!btn) return;
      const id = btn.getAttribute('data-id');
      if (!window.state || !state.data) return;
      const prod = state.data.find(d => String(d.ProductID) === String(id));
      openSeasonalUses(prod);
    });
  })();
</script>
<script>
  (function(){
    // Guard to avoid double-binding
    if (window.__seasonalUsesBound) return;
    window.__seasonalUsesBound = true;

    function ensureArray(x){
      if (!x) return [];
      if (Array.isArray(x)) return x.filter(Boolean).map(s => String(s).trim()).filter(Boolean);
      return String(x).split(/\r?\n|[;,|]/).map(s => s.trim()).filter(Boolean);
    }

    function getSeasonalUsesBySeason(prod){
      if (!prod) return null;
      const map = {
        Spring: ensureArray(prod['SeasonalUses-Spring']),
        Summer: ensureArray(prod['SeasonalUses-Summer']),
        Fall:   ensureArray(prod['SeasonalUses-Fall']),
        Winter: ensureArray(prod['SeasonalUses-Winter'])
      };
      // Remove empty seasons
      Object.keys(map).forEach(k => { if (!map[k] || !map[k].length) delete map[k]; });
      return map;
    }

    function openSeasonalUses(prod){
      const modal = document.getElementById('modal');
      const titleEl = document.getElementById('modalTitle');
      const content = document.getElementById('modalContent');

      if (!prod){
        titleEl.textContent = 'Seasonal Uses';
        content.innerHTML = `<button class="player-close" type="button" aria-label="Close">×</button>
          <div style="padding:12px;"><p>Sorry — no product selected.</p></div>`;
        modal.style.display = 'flex';
        content.querySelector('.player-close').onclick = () => { content.innerHTML=''; modal.style.display='none'; };
        return;
      }

      const seasons = getSeasonalUsesBySeason(prod);
      titleEl.textContent = (prod.ProductName || 'Seasonal Uses');

      if (!seasons || !Object.keys(seasons).length){
        content.innerHTML = `<button class="player-close" type="button" aria-label="Close">×</button>
          <div style="padding:12px;"><p>No Seasonal Uses are listed for this product.</p></div>`;
      } else {
        const blocks = Object.entries(seasons).map(([season, items]) => `
          <section style="margin:8px 0 12px;">
            <h4 style="margin:0 0 6px 0;">${season}</h4>
            <ul style="margin:0 0 0 18px; line-height:1.5;">
              ${items.map(u => `<li>${u}</li>`).join('')}
            </ul>
          </section>
        `).join('');
        content.innerHTML = `<button class="player-close" type="button" aria-label="Close">×</button>
          <div style="padding:12px;">
            <h3 style="margin-top:0;">Seasonal Uses</h3>
            ${blocks}
          </div>`;
      }

      const closeBtn = content.querySelector('.player-close');
      if (closeBtn) closeBtn.onclick = () => { content.innerHTML=''; modal.style.display='none'; };
      modal.style.display = 'flex';

      const escHandler = (e) => { if (e.key === 'Escape') { content.innerHTML=''; modal.style.display='none'; document.removeEventListener('keydown', escHandler); } };
      document.addEventListener('keydown', escHandler, { once: true });
    }

    // Delegate click for Seasonal Uses buttons (Learning Center detail card uses p.ProductID)
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-action="seasonal-uses"]');
      if (!btn) return;
      const id = btn.getAttribute('data-id');
      const prod = (window.state && state.data) ? state.data.find(d => String(d.ProductID) === String(id)) : null;
      openSeasonalUses(prod);
    });
  })();
</script>
<script>
(function(){
  const MOBILE = window.matchMedia('(max-width: 1024px)');
  let lastY = 0, ticking = false, headerEl = null;

  function getHeader(){
    return document.querySelector('header') || document.querySelector('.app-header') || document.querySelector('#header');
  }

  function onScroll(){
    if (!MOBILE.matches) return;
    if (ticking) return;
    window.requestAnimationFrame(() => {
      const y = window.scrollY || document.documentElement.scrollTop;
      headerEl = headerEl || getHeader();
      if (headerEl) {
        if (y > lastY && y > 80) { headerEl.classList.add('mobile-header-hidden'); }
        else { headerEl.classList.remove('mobile-header-hidden'); }
      }
      lastY = y;
      ticking = false;
    });
    ticking = true;
  }

  // Bottom Step Bar
  function ensureStepBar(){
    if (!MOBILE.matches) return;
    if (document.getElementById('mobileStepBar')) return;
    const bar = document.createElement('div');
    bar.id = 'mobileStepBar';
    bar.className = 'mobile-stepbar';
    bar.innerHTML = `
      <button id="msbStep1" type="button">1 Tractor <span class="badge" id="msbT">0</span></button>
      <button id="msbStep2" type="button">2 Attachments <span class="badge" id="msbA">0</span></button>
      <button id="msbStep3" type="button">3 Learning Center <span class="badge" id="msbL">0</span></button>
    `;
    // Insert before end of body so it sits above content
    document.body.appendChild(bar);

    // Navigation handlers
    const show = (id) => {
      const screens = Array.from(document.querySelectorAll('.screen'));
      if (screens.length) {
        screens.forEach(s => { s.style.display = (s.id === id) ? 'block' : 'none'; });
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      // Attempt to call existing render() if present
      if (typeof window.render === 'function') { try { window.render(); } catch(e){} }
      updateStepBar();
    };

    document.getElementById('msbStep1').onclick = () => show('screen-step1');
    document.getElementById('msbStep2').onclick = () => show('screen-step2');
    document.getElementById('msbStep3').onclick = () => show('screen-step3');
  }

  function updateStepBar(){
    if (!MOBILE.matches) return;
    const t = (window.state && state.tractors) ? state.tractors.size : 0;
    const a = (window.state && state.attachments) ? state.attachments.size : 0;
    const l = t + a;
    const T = document.getElementById('msbT');
    const A = document.getElementById('msbA');
    const L = document.getElementById('msbL');
    if (T) T.textContent = t;
    if (A) A.textContent = a;
    if (L) L.textContent = l;

    const s1 = document.getElementById('screen-step1');
    const s2 = document.getElementById('screen-step2');
    const s3 = document.getElementById('screen-step3');
    const b1 = document.getElementById('msbStep1');
    const b2 = document.getElementById('msbStep2');
    const b3 = document.getElementById('msbStep3');

    if (b1 && b2 && b3 && s1 && s2 && s3) {
      const visible = [s1,s2,s3].find(s => s.style.display !== 'none');
      b1.classList.toggle('active', visible === s1);
      b2.classList.toggle('active', visible === s2);
      b3.classList.toggle('active', visible === s3);
    }
  }

  // Wrap key renderers so counts stay up to date
  function wrap(fnName){
    const orig = window[fnName];
    if (typeof orig !== 'function') return;
    window[fnName] = function(){
      const res = orig.apply(this, arguments);
      try { updateStepBar(); } catch(e){}
      return res;
    };
  }

  document.addEventListener('DOMContentLoaded', () => {
    headerEl = getHeader();
    ensureStepBar();
    updateStepBar();
    wrap('renderTractorCarousel');
    wrap('renderAttachments');
    wrap('renderLearningCenter');
    wrap('render');
    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('resize', () => { ensureStepBar(); updateStepBar(); }, { passive: true });
  });

  // Also update on any click (selection toggles)
  document.addEventListener('click', () => { try { updateStepBar(); } catch(e){} }, true);
})();
</script>
<script>
// === Safe post-render patch: keep original logic, enhance visuals & wiring ===
(function(){
  // Only install once
  if (window.__lc_patch_installed) return;
  window.__lc_patch_installed = true;

  // Utilities
  function $all(sel, root){ return (root||document).querySelectorAll(sel); }
  function $(sel, root){ return (root||document).querySelector(sel); }

  function applySelectedStylingToStep2(){
    const container = $('#attachmentsContainer');
    if (!container) return;
    // Clear any previous 'selected' classes we added
    $all('.card.selected', container).forEach(el => el.classList.remove('selected'));

    // Add 'selected' to any card whose [data-add] id is in state.attachments
    if (window.state && state.attachments) {
      $all('[data-add]', container).forEach(btn => {
        const id = btn.getAttribute('data-add');
        if (state.attachments.has(id)) {
          const card = btn.closest('.card');
          if (card) card.classList.add('selected');
        }
      });
    }
  }

  function prependSelectedTractorsToStep2(){
    const container = $('#attachmentsContainer');
    if (!container || !window.state || !state.data) return;
    // remove any previously injected tractor cards (marked with data-lc-injected="tractor")
    $all('.card[data-lc-injected="tractor"]', container).forEach(n => n.remove());

    const ids = (state.tractors && state.tractors.size) ? Array.from(state.tractors) : [];
    if (!ids.length) return;

    const htmlList = ids.map(id => {
      const p = state.data.find(d => d.ProductID === id);
      if (!p || typeof buildDetailCard !== 'function') return '';
      // use existing builder and then mark selected and data attribute
      let card = buildDetailCard(p);
      card = card.replace('<div class="card">', '<div class="card selected" data-lc-injected="tractor">');
      card = card.replace('<div class="actions">', '<div class="actions"><span class="kbadge">Selected Tractor</span>');
      return card;
    }).join('');

    if (htmlList) container.insertAdjacentHTML('afterbegin', htmlList);
  }

  // Wrap original renderAttachments to enhance after it runs
  if (typeof window.renderAttachments === 'function' && !window.__ra_wrapped){
    const _orig = window.renderAttachments;
    window.renderAttachments = function(){
      _orig.apply(this, arguments);
      // enhance after original render completes
      applySelectedStylingToStep2();
      prependSelectedTractorsToStep2();
      // Re-wire buttons inside Step 2 (in case originals didn't cover these nodes)
      wireMediaButtonsInStep2();
      wireThumbsInStep2();
    };
    window.__ra_wrapped = true;
  }

  function wireMediaButtonsInStep2(){
    const container = $('#attachmentsContainer');
    if (!container) return;
    // Attach once per render based on current nodes
    $all('[data-video]', container).forEach(b => {
      if (b.__wired) return;
      b.addEventListener('click', () => {
        const id = b.getAttribute('data-video');
        const p = (typeof getProd==='function') ? getProd(id) : null;
        if (p && p.VideoURL) openViewer('Video', p.VideoURL);
      });
      b.__wired = true;
    });
    $all('[data-brochure]', container).forEach(b => {
      if (b.__wired) return;
      b.addEventListener('click', () => {
        const id = b.getAttribute('data-brochure');
        const p = (typeof getProd==='function') ? getProd(id) : null;
        if (p && p.BrochureURL) openViewer('Brochure', p.BrochureURL);
      });
      b.__wired = true;
    });
    $all('[data-manual]', container).forEach(b => {
      if (b.__wired) return;
      b.addEventListener('click', () => {
        const id = b.getAttribute('data-manual');
        const p = (typeof getProd==='function') ? getProd(id) : null;
        if (p && p.ManualURL) openViewer('Manual', p.ManualURL);
      });
      b.__wired = true;
    });
  }

  function wireThumbsInStep2(){
    const container = $('#attachmentsContainer');
    if (!container) return;
    $all('.thumbs img', container).forEach(img => {
      if (img.__wired) return;
      img.addEventListener('click', () => {
        const url = img.getAttribute('data-swap');
        const media = img.closest('.card').querySelector('.media');
        media.innerHTML = url ? `<img src="${url}" alt="image"/>` : '<div class="muted">No image</div>';
        const strip = img.closest('.thumbs');
        if (strip) strip.querySelectorAll('img').forEach(t => t.classList.remove('active'));
        img.classList.add('active');
      });
      img.__wired = true;
    });
  }

  // As a fallback, enhance current DOM on load
  window.addEventListener('load', () => {
    try {
      applySelectedStylingToStep2();
      prependSelectedTractorsToStep2();
      wireMediaButtonsInStep2();
      wireThumbsInStep2();
    } catch(e){ /* no-op */ }
  });
})();
</script>
<script>
// === Add "Find A Retailer" button to every product card ===
(function installRetailerButtons(){
  var RETAILER_URL = "https://summittractors.bullseyelocations.com/local/TRACTORSUPPLYALLSTORES";
  function addButtons(root){
    (root || document).querySelectorAll('.card .actions').forEach(function(actions){
      if (actions.querySelector('[data-retailer]')) return;
      var btn = document.createElement('button');
      btn.type = "button";
      btn.textContent = "Find A Retailer";
      btn.setAttribute('data-retailer','');
      btn.addEventListener('click', function(){
        if (typeof openViewer === 'function') {
          openViewer('Find A Retailer', RETAILER_URL);
        } else {
          window.open(RETAILER_URL, '_blank','noopener');
        }
      });
      actions.appendChild(btn);
    });
  }
  // Initial pass
  addButtons(document);
  // Observe future renders
  var mo = new MutationObserver(function(muts){
    addButtons(document);
  });
  mo.observe(document.body, { childList: true, subtree: true });
})();
</script>
<script>
// === Delegated handlers for Video / Brochure / Manual (robust across re-renders) ===
(function installMediaDelegation(){
  if (window.__mediaDelegationInstalled) return;
  document.addEventListener('click', function(e){
    var el = e.target.closest && (
      e.target.closest('[data-video]') ||
      e.target.closest('[data-brochure]') ||
      e.target.closest('[data-manual]')
    );
    if (!el) return;

    // Determine which attribute was clicked
    var pid = el.getAttribute('data-video') || el.getAttribute('data-brochure') || el.getAttribute('data-manual');
    if (!pid) return;

    // Resolve product and URL
    var prod = (typeof getProd === 'function') ? getProd(pid) : null;
    var url = null, title = '';
    if (el.hasAttribute('data-video')) { title = 'Video'; url = prod && prod.VideoURL; }
    else if (el.hasAttribute('data-brochure')) { title = 'Brochure'; url = prod && prod.BrochureURL; }
    else if (el.hasAttribute('data-manual')) { title = 'Manual'; url = prod && prod.ManualURL; }

    if (!url) return;

    // Open inside the app using the existing modal
    if (typeof openViewer === 'function') {
      openViewer(title, url);
    } else {
      window.open(url, '_blank', 'noopener');
    }
  });
  window.__mediaDelegationInstalled = true;
})();
</script>
<script>
// === Ensure selected cards visibly show border + checkmark across the app ===
(function installSelectionStyling(){
  if (window.__selectionStylingInstalled) return;

  function getSelectedNames(){
    var names = new Set();
    try {
      if (window.state && Array.isArray(state.data)) {
        if (state.tractors && state.tractors.size) {
          Array.from(state.tractors).forEach(function(id){
            var p = state.data.find(d => d.ProductID === id);
            if (p && p.ProductName) names.add(p.ProductName.trim());
          });
        }
        if (state.attachments && state.attachments.size) {
          Array.from(state.attachments).forEach(function(id){
            var p = state.data.find(d => d.ProductID === id);
            if (p && p.ProductName) names.add(p.ProductName.trim());
          });
        }
      }
    } catch(e){}
    return names;
  }

  function applySelectedStyling(root){
    var names = getSelectedNames();
    if (!names.size) return;
    (root || document).querySelectorAll('.card').forEach(function(card){
      var h = card.querySelector('h3');
      if (!h) return;
      var nm = (h.textContent || '').trim();
      if (names.has(nm)) card.classList.add('selected');
    });
  }

  // Click-to-toggle feedback for tractor select and attachment add/remove
  document.addEventListener('click', function(e){
    var btn = e.target.closest && (e.target.closest('#selectTractorBtn') || e.target.closest('[data-add]'));
    if (!btn) return;
    var card = btn.closest('.card');
    if (!card) return;
    // Toggle immediately for visual feedback; underlying state handlers still run as-is.
    card.classList.toggle('selected');
    // Re-apply after a tick to reflect any re-render
    setTimeout(function(){ applySelectedStyling(document); }, 50);
  }, true);

  // Apply on initial load
  window.addEventListener('load', function(){ applySelectedStyling(document); });

  // Re-apply on DOM mutations (e.g., after renders)
  var mo = new MutationObserver(function(){ applySelectedStyling(document); });
  mo.observe(document.body, {childList: true, subtree: true});

  window.__selectionStylingInstalled = true;
})();
</script>
<!-- Embedded CSV injected -->
<script id="embeddedCSV" type="text/csv">
ProductID,Category,Application,Model,ProductName,SKU,Price,DescriptionShort,DescriptionLong,KeyFeatures,SeasonalUses-Spring,SeasonalUses-Summer,SeasonalUses-Fall,SeasonalUses-Winter,ImageURLs,VideoURL,BrochureURL,ManualURL,SortOrder,Active
PI-RCX48,Attachment & Implement,Mowing & Brush Cutting,RCX48,"Summit 48"" Rotary Cutter",12345678,"$2,199.00 ",Opening Description,"The Summit 48"" Rotary Cutter is built to mow fields, pastures, and road edges, handling tall grass and brush with durable blades.","Summit 48"" Rotary Cutter is durable; Easy to use; Reliable performance","Start clearing overgrowth with Summit 48"" Rotary Cutter after wet conditions subside.","Summit 48"" Rotary Cutter handles tall grass and brush along fields, trails, and fence lines.","Cut back seasonal growth and tidy property edges with Summit 48"" Rotary Cutter.","Inspect and store Summit 48"" Rotary Cutter; grease pivots and check driveline components.",https://summittractors.com/summitpics/ROTARY-CUTTER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,2,TRUE
PI-QHX1,Attachment & Implement,Quick Hitch,QHX1,Summit QHX1 Quick Hitch,12345678,$299.00 ,Opening Description,The Summit QHX1 Quick Hitch attachment makes maneuvering trailers and implements quick and precise.,Summit QHX1 Quick Hitch is durable; Easy to use; Reliable performance,"Summit QHX1 Quick Hitch helps kick off the seasonâ€”setup, repairs, and soil prep so youâ€™re ready for busy months ahead.",Summit QHX1 Quick Hitch shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.,"Summit QHX1 Quick Hitch supports cleanup and prepâ€”manage residue, move materials, and button things up before winter.","Summit QHX1 Quick Hitch stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.",https://summittractors.com/summitpics/QUICK-HITCH.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,20,TRUE
PI-BBX60,Attachment & Implement,Grading & Landscaping,BBX60,"Summit 60"" Box Blade",12345678,"$1,199.00 ",Opening Description,"The Summit 60"" Box Blade is designed for grading, leveling, and pulling material, equipped with scarifiers for tougher jobs.",Levels surfaces; Robust steel; Easy to use,"Repair washouts and re-crown driveways with Summit 60"" Box Blade after winter weather.","Summit 60"" Box Blade maintains lanes, pads, and work areas during dry months.","Touch up grades and improve drainage paths with Summit 60"" Box Blade before freeze.","Use Summit 60"" Box Blade for light snow windrows or to manage runoff when thawing.",https://summittractors.com/summitpics/BOX-BLADE.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,7,TRUE
PI-BPX60,Attachment & Implement,Grading & Landscaping,BPX60,Summit BPX60 BoxPlane,12345678,"$2,599.00 ",Opening Description,The Summit BPX60 BoxPlane is a compact tractor attachment designed to improve productivity for property maintenance and farm tasks.,Levels surfaces; Robust steel; Easy to use,Repair washouts and re-crown driveways with Summit BPX60 BoxPlane after winter weather.,"Summit BPX60 BoxPlane maintains lanes, pads, and work areas during dry months.",Touch up grades and improve drainage paths with Summit BPX60 BoxPlane before freeze.,Use Summit BPX60 BoxPlane for light snow windrows or to manage runoff when thawing.,https://summittractors.com/summitpics/Boxplane-2---Copy.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,6,TRUE
PI-LPX60,Attachment & Implement,Grading & Landscaping,LPX60,"Summit 60"" Land Plane",12345678,"$1,299.00 ",Opening Description,"The Summit 60"" Land Plane levels and smooths gravel driveways and surfaces, quickly removing ruts and washboards.",Levels surfaces; Robust steel; Easy to use,"Repair washouts and re-crown driveways with Summit 60"" Land Plane after winter weather.","Summit 60"" Land Plane maintains lanes, pads, and work areas during dry months.","Touch up grades and improve drainage paths with Summit 60"" Land Plane before freeze.","Use Summit 60"" Land Plane for light snow windrows or to manage runoff when thawing.",https://summittractors.com/summitpics/LAND-PLANE.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,8,TRUE
PI-RBX60,Attachment & Implement,Grading & Landscaping,RBX60,"Summit 60"" Rear Blade",12345678,$799.00 ,Opening Description,"The Summit 60"" Rear Blade is a versatile blade for driveways and ditches, capable of grading, crowning, and light snow removal.",Levels surfaces; Robust steel; Easy to use,"Repair washouts and re-crown driveways with Summit 60"" Rear Blade after winter weather.","Summit 60"" Rear Blade maintains lanes, pads, and work areas during dry months.","Touch up grades and improve drainage paths with Summit 60"" Rear Blade before freeze.","Use Summit 60"" Rear Blade for light snow windrows or to manage runoff when thawing.",https://summittractors.com/summitpics/REAR-BLADE.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,9,TRUE
PI-LRX60,Attachment & Implement,Grading & Landscaping,LRX60,"Summit 60"" Landscape Rake",12345678,$899.00 ,Opening Description,"The Summit 60"" Landscape Rake collects rocks and debris, smooths topsoil, and grooms gravel for a clean, finished look.",Smooth raking; Durable tines; Easy attachment,"Rake out debris and prep beds and trails with Summit 60"" Landscape Rake.","Summit 60"" Landscape Rake grooms gravel, trails, and grounds for a clean finish.","Windrow leaves and surface debris with Summit 60"" Landscape Rake for quick cleanup.","Store and service Summit 60"" Landscape Rake so itâ€™s ready for spring.",https://summittractors.com/summitpics/LANDSCAPE-RAKE.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,10,TRUE
PI-GX54,Attachment & Implement,Material Handling,GX54,"Summit 54"" SSQA Grapple",12345678,"$2,499.00 ",Opening Description,"The Summit 54"" SSQA Grapple grips logs, brush, and debris securely, making land clearing and storm cleanup more efficient.",High lift capacity; Secure grip; Works with logs and debris,"Use Summit 54"" SSQA Grapple to lift and stack limbs from storms and winter pruning.","Summit 54"" SSQA Grapple moves logs, brush, and debris during landscaping and clearing.","Load firewood and clean fence lines with Summit 54"" SSQA Grapple.","Stage Summit 54"" SSQA Grapple for storm cleanup or move logs/firewood as needed.",https://summittractors.com/summitpics/GRAPPLE-LOG-TIGHT---Copy.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,4,TRUE
PI-PFX42,Attachment & Implement,Material Handling,PFX42,"Summit 42"" SSQA Pallet Forks",12345678,"$1,199.00 ",Opening Description,"The Summit 42"" SSQA Pallet Forks lifts and transports pallets, feed, and materials, turning a compact tractor into a handy forklift.",Move pallets; Adjustable spacing; Heavy-duty frame,"Unload mulch, soil, and building supplies with Summit 42"" SSQA Pallet Forks to start projects.","Summit 42"" SSQA Pallet Forks moves pallets, feed, and materials around the property.","Shift totes, firewood, and supplies with Summit 42"" SSQA Pallet Forks for winter prep.","Use Summit 42"" SSQA Pallet Forks to handle salt, sand, or bundled materials in cold weather.",https://summittractors.com/summitpics/PALLET-FORKS.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,11,TRUE
PI-BPX1,Attachment & Implement,Material Handling,BPX1,Summit BPX1 Boom Pole,12345678,$299.00 ,Opening Description,"The Summit BPX1 Boom Pole lifts engines, materials, or supplies, extending tractor reach for loading and handling.",Summit BPX1 Boom Pole is durable; Easy to use; Reliable performance,"Move planters, fencing, tools, and materials with Summit BPX1 Boom Pole to launch projects.",Summit BPX1 Boom Pole hauls supplies and equipment where you need themâ€”fast.,Use Summit BPX1 Boom Pole for firewood and harvest-season handling.,Relocate bundled goods and keep supplies organized with Summit BPX1 Boom Pole.,https://summittractors.com/summitpics/BOOM-POLE.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,14,TRUE
PI-CAX1,Attachment & Implement,Material Handling,CAX1,Summit CAX1 Carry All,12345678,$299.00 ,Opening Description,"The Summit CAX1 Carry All carries tools, supplies, and firewood, making transport around the property simple.",Summit CAX1 Carry All is durable; Easy to use; Reliable performance,"Move planters, fencing, tools, and materials with Summit CAX1 Carry All to launch projects.",Summit CAX1 Carry All hauls supplies and equipment where you need themâ€”fast.,Use Summit CAX1 Carry All for firewood and harvest-season handling.,Relocate bundled goods and keep supplies organized with Summit CAX1 Carry All.,https://summittractors.com/summitpics/CARRY-ALL.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,13,TRUE
PI-TMX1,Attachment & Implement,Trailer Moving,TMX1,Summit TMX1 Trailer Mover,12345678,$299.00 ,Opening Description,The Summit TMX1 Trailer Mover attachment makes maneuvering trailers and implements quick and precise.,Summit TMX1 Trailer Mover is durable; Easy to use; Reliable performance,"Move planters, fencing, tools, and materials with Summit TMX1 Trailer Mover to launch projects.",Summit TMX1 Trailer Mover hauls supplies and equipment where you need themâ€”fast.,Use Summit TMX1 Trailer Mover for firewood and harvest-season handling.,Relocate bundled goods and keep supplies organized with Summit TMX1 Trailer Mover.,https://summittractors.com/summitpics/TRAILER-MOVER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,12,TRUE
PI-FMX60,Attachment & Implement,Mowing & Brush Cutting,FMX60,"Summit 60"" 3-Point Finish Mower",12345678,"$2,500.00 ",Opening Description,"The Summit 60"" 3-Point Finish Mower delivers a smooth, lawn quality cut across large turf areas, ideal for estates and grounds maintenance.",Sharp cutting deck; Adjustable height; Durable construction,"Mount Summit 60"" 3-Point Finish Mower early to knock down fast-growing grass and restore lawns and acreage.","Summit 60"" 3-Point Finish Mower maintains lawns, pastures, and road edges through peak growth.","Use Summit 60"" 3-Point Finish Mower for final cuts and to mulch leaves before winter.","Service and store Summit 60"" 3-Point Finish Mower; sharpen blades and check belts for the next season.",https://summittractors.com/summitpics/FINISH-MOWER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,3,TRUE
PI-SSX500,Attachment & Implement,Seeding/spreading,SSX500,Summit SSX500 Seeder/Spreader,12345678,$799.00 ,Opening Description,"The Summit SSX500 Seeder/Spreader distributes seed, fertilizer, or lime evenly to promote uniform growth.",Summit SSX500 Seeder/Spreader is durable; Easy to use; Reliable performance,Apply seed and fertilizer precisely with Summit SSX500 Seeder/Spreader to jump-start growth.,Summit SSX500 Seeder/Spreader shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.,Overseed lawns or apply lime/fertilizer with Summit SSX500 Seeder/Spreader for strong spring emergence.,"Summit SSX500 Seeder/Spreader stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.",https://summittractors.com/summitpics/SEEDER-SPREADER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,15,TRUE
PI-SPX60,Attachment & Implement,Snow Management,SPX60,"Summit 60"" Snow Pusher",12345678,$799.00 ,Opening Description,"The Summit 60"" Snow Pusher is built for efficient snow clearing, pushing heavy accumulations from driveways and lots.",Heavy-duty blade; Clears snow quickly; Built for winter use,"Use Summit 60"" Snow Pusher to push late-season slush and tidy piles; then rinse and store for next winter.","Off-season care for Summit 60"" Snow Pusher: inspect wear parts, repaint as needed, and store out of weather.","Stage Summit 60"" Snow Pusher for the first snowâ€”inspect edges, check hardware, and position it for quick deployment.","Summit 60"" Snow Pusher is built for winterâ€”clear driveways and lots, push heavy snow, and keep access open when storms hit.",https://summittractors.com/summitpics/SNOW-PUSHER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,19,TRUE
PI-SPX60DK,Attachment & Implement,Snow Management,SPX60DK,"Summit 60"" Snow Pusher Drag Kit",12345678,$999.00 ,Opening Description,"The Summit 60"" Snow Pusher Drag Kit is built for efficient snow clearing, pushing heavy accumulations from driveways and lots.",Heavy-duty blade; Clears snow quickly; Built for winter use,"Use Summit 60"" Snow Pusher Drag Kit to push late-season slush and tidy piles; then rinse and store for next winter.","Off-season care for Summit 60"" Snow Pusher Drag Kit: inspect wear parts, repaint as needed, and store out of weather.","Stage Summit 60"" Snow Pusher Drag Kit for the first snowâ€”inspect edges, check hardware, and position it for quick deployment.","Summit 60"" Snow Pusher Drag Kit is built for winterâ€”clear driveways and lots, push heavy snow, and keep access open when storms hit.",https://summittractors.com/summitpics/SNOW-PUSHER-DRAG.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,20,TRUE
PI-MBSSX1,Attachment & Implement,Tillage & Soil Management,MBSSX1,Summit MBSSX1 Middle Buster-SubSoiler,12345678,$329.00 ,Opening Description,"The Summit MBSSX1 Middle Buster Sub-Soiler Combo breaks hardpan, improves drainage, and opens furrows for planting.",Summit MBSSX1 Middle Buster Sub-Soiler Combo is durable; Easy to use; Reliable performance,Apply seed and fertilizer precisely with Summit MBSSX1 Middle Buster Sub-Soiler Combo to jump-start growth.,Summit MBSSX1 Middle Buster Sub-Soiler Combo shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.,Overseed lawns or apply lime/fertilizer with Summit MBSSX1 Middle Buster Sub-Soiler Combo for strong spring emergence.,"Summit MBSSX1 Middle Buster Sub-Soiler Combo stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.",https://summittractors.com/summitpics/MIDDLE-BUSTER-SUB-SOILER-COMBO.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,16,TRUE
PI-MBX1,Attachment & Implement,Tillage & Soil Management,MBX1,Summit MBX1 Middle Buster,12345678,$299.00 ,Opening Description,"The Summit MBX1 Middle Buster breaks hardpan, improves drainage, and opens furrows for planting.",Summit MBX1 Middle Buster is durable; Easy to use; Reliable performance,Apply seed and fertilizer precisely with Summit MBX1 Middle Buster to jump-start growth.,Summit MBX1 Middle Buster shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.,Overseed lawns or apply lime/fertilizer with Summit MBX1 Middle Buster for strong spring emergence.,"Summit MBX1 Middle Buster stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.",https://summittractors.com/summitpics/MIDDLE-BUSTER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,17,TRUE
PI-SSX1,Attachment & Implement,Tillage & Soil Management,SSX1,Summit SSX1 Sub-Soiler,12345678,$299.00 ,Opening Description,The Summit SSX1 Sub-Soiler is a compact tractor attachment designed to improve productivity for property maintenance and farm tasks.,Summit SSX1 Sub-Soiler is durable; Easy to use; Reliable performance,Apply seed and fertilizer precisely with Summit SSX1 Sub-Soiler to jump-start growth.,Summit SSX1 Sub-Soiler shines in routine maintenance and productivityâ€”keep projects moving and properties looking great.,Overseed lawns or apply lime/fertilizer with Summit SSX1 Sub-Soiler for strong spring emergence.,"Summit SSX1 Sub-Soiler stays useful in cold weatherâ€”storage, upkeep, or snow-related tasks where applicable.",https://summittractors.com/summitpics/SUBSOILER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,18,TRUE
PI-RTLRX48,Attachment & Implement,Tillage & Soil Management,RTLRX48,"Summit 48"" Rotary Tiller",12345678,"$2,699.00 ",Opening Description,"The Summit 48"" Rotary Tiller prepares soil for planting by breaking ground, mixing amendments, and cultivating gardens and plots.",Strong tines; Soil preparation; Easy depth adjustment,"Prepare gardens and food plots with Summit 48"" Rotary Tillerâ€”break ground, mix amendments, and create seedbeds.","Use Summit 48"" Rotary Tiller for mid-season cultivation and weed control where appropriate.","Incorporate residues and prep beds for spring using Summit 48"" Rotary Tiller.","Clean, grease, and store Summit 48"" Rotary Tiller under cover to prevent rust.",https://summittractors.com/summitpics/TILLER.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,1,TRUE
PI-AFDHX60,Attachment & Implement,Tillage & Soil Management,AFDHX60,"Summit 60"" Angle Frame Disc Harrow",12345678,"$1,299.00 ",Opening Description,"The Summit 60"" Angle Frame Disc Harrow breaks up soil clods and incorporates residue, prepping ground for planting or leveling.",Strong tines; Soil preparation; Easy depth adjustment,"Prepare gardens and food plots with Summit 60"" Angle Frame Disc Harrowâ€”break ground, mix amendments, and create seedbeds.","Use Summit 60"" Angle Frame Disc Harrow for mid-season cultivation and weed control where appropriate.","Incorporate residues and prep beds for spring using Summit 60"" Angle Frame Disc Harrow.","Clean, grease, and store Summit 60"" Angle Frame Disc Harrow under cover to prevent rust.",https://summittractors.com/summitpics/AFDHX60_BR.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,5,TRUE
PI-TX25HLX85,Attachment & Implement,Tractor,TX25HLX85,Summit TX25H Tractor & Loader,6014687,"$19,499.00 ",Opening Description,"The Summit TX25H compact tractor is a versatile, year-round workhorse designed to handle a wide range of tasks with ease. With the right attachments, it can mow, grade, haul, dig, till, and clear snow, delivering the power of a larger tractor in a smaller, more maneuverable package. This adaptability makes the TX25H a smart investment for property owners who want one machine that can do it all.",24.7 HP Mitsubishi 3-Cyl. EPA Tier 4 Diesel Engine; 3rd Function Hydraulics - Grapple Ready; Rear Hydraulic Remotes; Self-Leveling SSQA Loader; Goodyear All-Condition R14T Tires; RimGuard Liquid Tire Ballast in the Rears; Premium Suspension Seat With Backrest Extension; Toolbox; Rear Work Light; Swinging Drawbar; Cross Drawbar; Front Tow hook,"The Summit TX25H Tractor is built to get your property ready for the season. In spring, it handles soil preparation with ease, whether you are tilling, cultivating, or discing gardens, fields, and food plots. Pair it with seeders and spreaders to make planting efficient, and use its loader and grading tools to clear branches, haul brush, and repair driveways after winter.","Through the summer months, the Summit TX25H shines as a mowing and maintenance machine. Attach a rotary cutter for pastures, a finishing mower for lawns, or a flail mower for roadside and ditch upkeep. With pallet forks and loaders, it moves hay bales, feed, and supplies, while also tackling fencing projects, gravel spreading, light construction, and crop irrigation with sprayers or tanks.","Summit TX25H Tractor & LX85 Loader supports harvest, cleanup, and drainage improvements.","In winter, the Summit TX25H becomes a dependable snow and ice management solution. With front-end loaders, blades, pushers, or snow blowers, it clears driveways and access roads quickly and efficiently. It also manages livestock chores by moving feed and bedding, spreads salt or sand for ice control, and keeps your property accessible in all conditions.",https://summittractors.com/summitpics/Dump---Copy.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,1,TRUE
TX25HLX85BHX76,Attachment & Implement,Tractor,TX25HLX85BHX76,Summit TX25H Tractor & Loader & Backhoe,6014686,"$27,499.00 ",Opening Description,"Pairing the Summit BHX76 Backhoe with the Summit TX25H transforms the tractor into a true digging and excavation machine. The backhoe makes it easy to handle jobs like trenching for utilities, planting trees, removing stumps, and clearing ditches, tasks a tractor alone cannot tackle. Together, they create a powerful, all-in-one solution for year-round property maintenance and improvement.","All Features of the Summit TX25H Tractor & LX85 Loader; Mechanical Thumb to Lift Boulders; Logs and Other Material; Independent Operator Seat - No Need to Pivot the Tractor Seat Around; Standard 12"" Bucket; Optional 8"" & 16"" Buckets; Backhoe On/Off the Tractor in Minutes; Locking Pin Keepers so They Don't Get Lost; ISO SAE Operator Controls; Full Subframe Mount; SMV Sign for Transport Safety on the Road","The Summit TX25H Tractor, paired with the Summit BHX76 Backhoe, makes spring work simple and efficient. Use the tractor for soil preparation like tilling, cultivating, and discing, then hook up seeders and spreaders to get planting underway. The BHX76 Backhoe is ideal for digging trenches for irrigation lines, planting trees, or removing stubborn stumps. Together, they handle property cleanup by clearing branches, hauling brush, and repairing driveways after winter.ields, gardens, and landscaping projects","Through the summer months, the Summit TX25H takes care of mowing and pasture maintenance with rotary cutters, finishing mowers, or flail mowers. Its loader and forks move hay bales, feed, and building materials with ease. The Summit BHX76 Backhoe adds construction capability, making quick work of post hole digging, trenching for utilities, and small excavation projects around your property. With this combination, you can handle fencing, landscaping, and water system installations all season long.","When fall arrives, the Summit TX25H supports harvest with the strength to pull wagons, haul produce, and power augers. It also preps land for winter with cover crop planting, fertilizing, and tilling residue back into the soil. The BHX76 Backhoe extends your reach by digging drainage ditches, clearing out culverts, and helping with tree planting or removal. Together, they simplify leaf cleanup, property maintenance, and firewood preparation, from hauling logs to splitting wood with a PTO-powered splitter.","In winter, the Summit TX25H Tractor transforms into a dependable snow and ice management machine, using loaders, blades, pushers, or snow blowers to keep driveways and access roads clear. It also manages livestock chores by moving feed and bedding, and spreads sand or salt for ice control. With the Summit BHX76 Backhoe, you can dig out compacted snow piles, clear drainage areas, or handle utility repairs even in frozen ground. This pairing ensures your property stays productive and accessible all winter long.",https://summittractors.com/summitpics/SUMMIT-TX25HLX85BHX76.png,https://youtu.be/IT1jIBeAGvw?si=Vm9Q2YAFRLI2bJIC,https://summittractors.com/8.5x11-brochure-3.24.25.pdf,https://summittractors.com/manuals/Summit%20TX25%20Operator%20Manual.pdf,2,TRUE

</script>
<script>
// Self-contained CSV loader with fallback parser
(function(){ 
  function simpleCSVParse(text){ 
    // Minimal CSV parser: handles commas, semicolons in fields if quoted, and newlines.
    // Returns { headers:[], rows:[] } where rows are array of objects.
    const lines = text.replace(/\r\n?/g, '\n').split('\n').filter(l=>l.trim().length>0);
    if (!lines.length) return {headers:[], rows:[]};
    function splitCSV(line){
      const out = [];
      let cur = '';
      let inQ = false;
      for (let i=0;i<line.length;i++){ 
        const c = line[i], n = line[i+1];
        if (c === '"') {
          if (inQ && n === '"') { cur += '"'; i++; }
          else inQ = !inQ;
        } else if (c === ',' && !inQ) { out.push(cur); cur=''; }
        else { cur += c; }
      }
      out.push(cur);
      return out.map(s => s.trim());
    }
    const headers = splitCSV(lines[0]).map(h=>h.replace(/^\uFEFF/,'').trim());
    const rows = [];
    for (let i=1;i<lines.length;i++){ 
      const vals = splitCSV(lines[i]);
      if (vals.every(v=>!v)) continue;
      const obj = {};
      for (let j=0;j<headers.length;j++) obj[headers[j]] = vals[j]!==undefined?vals[j]:"";
      rows.push(obj);
    }
    return {headers, rows};
  }
  function loadEmbeddedCSV(){
    var tag = document.getElementById('embeddedCSV');
    if (!tag) return;
    var text = tag.textContent || tag.innerText || '';
    if (!text.trim()) return;
    try {
      var parsed = (typeof parseCSV === 'function') ? parseCSV(text) : simpleCSVParse(text);
      if (parsed && parsed.rows && parsed.rows.length) {
        window.state = window.state || {};
        state.data = parsed.rows;
        // Ensure Sets exist
        state.tractors = new Set(state.tractors || []);
        state.attachments = new Set(state.attachments || []);
        // Trigger renders if available
        if (typeof renderTractorCarousel === 'function') renderTractorCarousel();
        if (typeof renderAttachments === 'function') renderAttachments();
        if (typeof renderLearningCenter === 'function') renderLearningCenter();
        var overlay = document.getElementById('overlay'); if (overlay) overlay.style.display = 'none';
      }
    } catch(e) {
      console.warn('Embedded CSV load failed:', e);
    }
  }
  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', loadEmbeddedCSV);
  else loadEmbeddedCSV();
})();
</script>
<script>
// Safety: ensure welcome "Enter" routes to Step 2
(function(){
  var btn = document.getElementById('enterBtn');
  if (btn && !btn.__patched) {
    btn.addEventListener('click', function(){ try { setActiveStep('step2'); } catch(e){} });
    btn.__patched = true;
  }
  // If the overlay listens for Enter key, route to step2
  document.addEventListener('keydown', function(e){
    var active = document.querySelector('section#screen-welcome, section[data-screen="welcome"]');
    if (!active) return;
    if (e.key === 'Enter') {
      try { setActiveStep('step2'); e.preventDefault(); } catch(err){}
    }
  });
})();
</script>
<script></script>
<script>
  (function(){
    // Force "Save or Print Your Selections" to open inline viewer, without external pop-ups
    try {
      document.querySelectorAll('.step[data-step="saveprint"]').forEach(function(st){
        st.addEventListener('click', function(){
          try { setActiveStep('saveprint'); } catch(e){}
          try { openSavePrintInline(); } catch(e){ console.warn(e); }
        });
      });
    } catch(e){ console.warn('saveprint bind error', e); }
  })();
</script>
<script>
function buildSummaryCard(p){
  try {
    const imgs = (typeof getImages==='function') ? getImages(p) : [];
    const main = (imgs && imgs[0]) || p.ImageURL || p.PrimaryImageURL || '';
    const sel = (window.state && state.attachments && state.attachments.has) ? state.attachments.has(p.ProductID) : false;
    const short = (p.DescriptionShort || '').trim();
    return `
      <div class="card" data-prod="${p.ProductID}">
        <div class="media">${main ? `<img src="${main}" alt="${p.ProductName||'image'}">` : '<div class="muted">No image</div>'}</div>
        <div class="body">
          <h3>${p.ProductName || 'Product'}</h3>
          ${short ? `<p class="muted" style="margin-top:6px">${short}</p>` : ''}
          <div class="actions">
            <button data-add="${p.ProductID}" type="button">${sel ? 'Remove' : 'Select'}</button>
            <button class="secondary" data-preview="${p.ProductID}" type="button">Preview</button>
            <button class="see-details" data-details="${p.ProductID}" type="button">See Details</button>
          </div>
        </div>
      </div>`;
  } catch(e){
    // Fallback to existing detail card if anything goes wrong
    try {
      const base = buildDetailCard(p);
      const sel = state.attachments.has(p.ProductID);
      const extras = `
        <button data-add="${p.ProductID}" type="button">${sel ? 'Remove' : 'Select'}</button>
        <button class="secondary" data-preview="${p.ProductID}" type="button">Preview</button>
        <button class="see-details" data-details="${p.ProductID}" type="button">See Details</button>
      `;
      return base.replace('<div class="actions">', `<div class="actions">${extras}`);
    } catch(_) {
      return '<div class="card"><div class="body"><div class="muted">Unable to render card.</div></div></div>';
    }
  }
}

function openDetailModal(id){
  try{
    const p = (typeof getProd==='function') ? getProd(id) : (state && state.data ? state.data.find(d=>d.ProductID===id) : null);
    if (!p) return;
    var modal = document.getElementById('modal');
    var titleEl = document.getElementById('modalTitle');
    var content = document.getElementById('modalContent');
    if (!modal || !titleEl || !content){
      // Fallback: replace inline card with detail card markup
      const host = document.querySelector('.card[data-prod="'+id+'"]');
      if (host){
        let html = buildDetailCard(p);
        html = html.replace('<div class="actions">', '<div class="actions"><button class="see-details" type="button" onclick="location.reload()">Hide Details</button>');
        host.outerHTML = '<div class="card">'+html+'</div>';
      }
      return;
    }
    titleEl.textContent = p.ProductName || 'Details';
    content.innerHTML = buildDetailCard(p);
    modal.style.display = 'flex';
  } catch(e){}
}
</script>
<script>
function openStep2() {
  if (typeof setStep === 'function') setStep(2);
  if (typeof showStep === 'function') showStep(2);
  if (document.getElementById('step2')) {
    document.getElementById('step2').style.display = '';
  }
  if (typeof renderAttachments === 'function') renderAttachments();
}
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('viewSelectEquipment')
    || document.querySelector('[data-action="view-select-equipment"]')
    || document.querySelector('button[title="View & Select Equipment"]')
    || document.querySelector('button:contains("View & Select Equipment")');
  if (btn) btn.addEventListener('click', openStep2);
});
</script>
<script>
(function(){
  function findAttachmentsContainer(){
    return document.getElementById('attachmentsContainer')
        || document.getElementById('attachmentsGrid')
        || document.querySelector('[data-role="attachments-grid"]')
        || null;
  }

  function addSeeDetailsButtons(scope){
    scope = scope || findAttachmentsContainer() || document;
    const cards = scope.querySelectorAll('.card .actions');
    cards.forEach(act => {
      if (act.querySelector('[data-details]')) return;
      let id = (act.querySelector('[data-preview]') && act.querySelector('[data-preview]').getAttribute('data-preview'))
            || (act.querySelector('[data-add]') && act.querySelector('[data-add]').getAttribute('data-add'))
            || null;
      if (!id) return;
      const btn = document.createElement('button');
      btn.className = 'see-details';
      btn.type = 'button';
      btn.setAttribute('data-details', id);
      btn.textContent = 'See Details';
      act.appendChild(btn);
    });
  }

  function wireSeeDetailsHandlers(scope){
    scope = scope || document;
    scope.querySelectorAll('[data-details]').forEach(b => {
      if (b.__wiredDetails) return;
      b.__wiredDetails = true;
      b.addEventListener('click', () => {
        const id = b.getAttribute('data-details');
        if (!id) return;
        try {
          const p = (typeof getProd === 'function') ? getProd(id) : null;
          const modal = document.getElementById('modal') || document.querySelector('#modal');
          const modalTitle = document.getElementById('modalTitle') || document.querySelector('#modalTitle');
          const modalContent = document.getElementById('modalContent') || document.querySelector('#modalContent');
          if (!modal || !modalTitle || !modalContent) return;
          if (p) modalTitle.textContent = p.ProductName || 'Details';
          if (typeof buildDetailCard === 'function' && p){
            modalContent.innerHTML = buildDetailCard(p);
          } else if (typeof openProductModal === 'function'){
            openProductModal(id);
            return;
          } else {
            modalContent.innerHTML = '<div class="muted">Details unavailable.</div>';
          }
          modal.style.display = 'flex';
        } catch(e){
          console.warn('See Details failed', e);
        }
      });
    });
  }

  // Step 2 opener
  function openStep2(){
    if (typeof setStep === 'function') setStep(2);
    if (typeof showStep === 'function') showStep(2);
    const s2 = document.getElementById('step2');
    if (s2) s2.style.display = '';
    if (typeof renderAttachments === 'function') renderAttachments();
    // After render, ensure buttons exist & are wired
    setTimeout(function(){
      addSeeDetailsButtons();
      wireSeeDetailsHandlers();
    }, 0);
  }

  // Wire View & Select Equipment
  function wireOpenButton(){
    const btn = document.getElementById('viewSelectEquipment')
      || document.querySelector('[data-action="view-select-equipment"]')
      || Array.from(document.querySelectorAll('button')).find(b => /view\s*&\s*select\s*equipment/i.test(b.textContent || ''));
    if (btn && !btn.__wiredStep2){
      btn.__wiredStep2 = true;
      btn.addEventListener('click', openStep2);
    }
  }

  // Observe attachments container for re-renders and inject See Details
  let obs = null;
  function observeGrid(){
    const grid = findAttachmentsContainer();
    if (!grid) return;
    if (obs) obs.disconnect();
    obs = new MutationObserver(() => {
      addSeeDetailsButtons(grid);
      wireSeeDetailsHandlers(grid);
    });
    obs.observe(grid, { childList: true, subtree: true });
    // Initial pass
    addSeeDetailsButtons(grid);
    wireSeeDetailsHandlers(grid);
  }

  document.addEventListener('DOMContentLoaded', function(){
    wireOpenButton();
    observeGrid();
  });
})();
</script>
<!-- 3-Button Footer for Tablet & Mobile -->
<div class="mobile-stepbar" id="mobileFooter">
<button class="primary" id="btnGoStep2" type="button">View &amp; Select Equipment</button>
<button id="btnGoSavePrint" type="button">Save or Print</button>
<button id="btnGoContact" type="button">Send Selections to Summit Tractors</button>
</div>
<script>
(function(){
  function gotoStep(step){
    try {
      if (typeof setActiveStep === 'function') setActiveStep(step);
      // If Save/Print, also trigger inline viewer when available
      if (step === 'saveprint') {
        var saveStep = document.querySelector('.step[data-step="saveprint"]');
        if (saveStep) { saveStep.click(); }
        if (typeof openSavePrintInline === 'function') { try { openSavePrintInline(); } catch(e){} }
      }
      // Ensure contact opens intro screen (a listener already sets this, but this is safe)
      if (step === 'contact') {
        var contactStep = document.querySelector('.step[data-step="contact"]');
        if (contactStep) contactStep.click();
      }
      window.scrollTo(0,0);
    } catch(e){ console.warn('gotoStep error', e); }
  }

  function bindFooter(){
    var f = document.getElementById('mobileFooter');
    if (!f) return;
    var b2 = document.getElementById('btnGoStep2');
    var bS = document.getElementById('btnGoSavePrint');
    var bC = document.getElementById('btnGoContact');
    if (b2) b2.onclick = function(){ gotoStep('step2'); };
    if (bS) bS.onclick = function(){ gotoStep('saveprint'); };
    if (bC) bC.onclick = function(){ gotoStep('contact'); };
  }

  if (document.readyState !== 'loading') bindFooter();
  else document.addEventListener('DOMContentLoaded', bindFooter);
})();
</script>
<!-- MOBILE_FOOTER_WIRING START -->
<script>
(function(){
  function gotoStep(step){
    try {
      // Try common APIs in the app to navigate
      if (typeof setStep === 'function') setStep(step === 'step2' ? 2 : step);
      if (typeof showStep === 'function') showStep(step === 'step2' ? 2 : step);
      // Fallback to clicking known step links/buttons
      if (step === 'step2') {
        const btn = document.getElementById('viewSelectEquipment') ||
                    document.querySelector('[data-action="view-select-equipment"]');
        if (btn) btn.click();
      } else if (step === 'saveprint') {
        const el = document.querySelector('[data-step="saveprint"], #savePrint, .js-save-print');
        if (el) el.click();
      } else if (step === 'contact') {
        const el = document.querySelector('[data-step="contact"], #contact, .js-contact');
        if (el) el.click();
      }
      window.scrollTo({ top: 0, behavior: 'smooth' });
    } catch(e) { console.warn('gotoStep error', e); }
  }

  function bindFooter(){
    const f = document.getElementById('mobileFooter');
    if (!f) return;
    const b2 = document.getElementById('btnGoStep2');
    const bS = document.getElementById('btnGoSavePrint');
    const bC = document.getElementById('btnGoContact');
    if (b2) b2.onclick = function(){ gotoStep('step2'); };
    if (bS) bS.onclick = function(){ gotoStep('saveprint'); };
    if (bC) bC.onclick = function(){ gotoStep('contact'); };
  }

  if (document.readyState !== 'loading') bindFooter();
  else document.addEventListener('DOMContentLoaded', bindFooter);
})();
</script>
<!-- MOBILE_FOOTER_WIRING END -->
<script>

function returnToStep2() {
  try {
    // Preferred: app-provided entry that also renders the grid
    if (typeof openStep2 === 'function') { openStep2(); return; }
    // Next best: built-in navigation helpers
    if (typeof setActiveStep === 'function') { setActiveStep('step2'); return; }
    if (typeof setStep === 'function') { setStep(2); return; }
    if (typeof showStep === 'function') { showStep(2); return; }
  } catch (e) { console.warn('returnToStep2 nav api error:', e); }
  // DOM fallback + try to invoke renderers if present
  try {
    document.querySelectorAll('.screen').forEach(function(el){ el.style.display = 'none'; });
    var s2 = document.getElementById('screen-step2') || document.getElementById('step2');
    if (s2) {
      s2.style.display = '';
      s2.removeAttribute('hidden');
      s2.setAttribute('aria-hidden','false');
      s2.classList && s2.classList.remove('hidden','is-hidden','d-none');
    }
    // If the product grid is data-driven, attempt common renderers
    if (typeof renderAttachments === 'function') { try { renderAttachments(); } catch(e){} }
    if (typeof renderProducts === 'function') { try { renderProducts(); } catch(e){} }
    if (typeof initStep2 === 'function') { try { initStep2(); } catch(e){} }
    window.scrollTo({ top: 0, behavior: 'instant' });
  } catch (e) { console.warn('returnToStep2 fallback error:', e); }
}

</script>
<!-- LC7 Enforce Step 2 on Close START -->
<script>
(function(){
  // Ensure global helper exists
  window.returnToStep2 = window.returnToStep2 || function(){
    if (typeof window.setActiveStep === 'function') { try { window.setActiveStep(2); } catch(e){} }
    else if (typeof window.showStep === 'function') { try { window.showStep(2); } catch(e){} }
    // try scrolling to top of step 2
    var s2 = document.getElementById('step2') || document.querySelector('[data-step="2"]');
    if (s2) { try { s2.scrollIntoView({behavior:'smooth', block:'start'}); } catch(e){} }
  };

  // Wrap/patch common close functions if present
  ['closeModal','hideModal','closePanel','hidePanel','dismissModal','closeDialog'].forEach(function(name){
    var fn = window[name];
    if (typeof fn === 'function') {
      window[name] = function(){
        try { return fn.apply(this, arguments); }
        finally { window.returnToStep2(); }
      };
    }
  });

  // Delegate clicks on elements that look like close buttons
  document.addEventListener('click', function(e){
    var t = e.target;
    if (!t) return;
    // traverse up to find close-ish element
    var el = t.closest('[data-close],[data-action="close"],.modal-close,.dialog-close,[aria-label="Close"],button[title="Close"],[data-dismiss="modal"]');
    if (el) {
      setTimeout(window.returnToStep2, 0);
    }
  }, true);

  // ESC key closes -> route to step 2 as well
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' || e.key === 'Esc') {
      setTimeout(window.returnToStep2, 0);
    }
  });
})();
</script>
<!-- LC7 Enforce Step 2 on Close END -->
<!-- LC7 CLOSE PATCH START -->
<script>
(function(){
  // Avoid multiple installs
  if (window.__LC7_CLOSE_PATCH__) return;
  window.__LC7_CLOSE_PATCH__ = true;

  
function returnToStep2() {
  try {
    // Preferred: app-provided entry that also renders the grid
    if (typeof openStep2 === 'function') { openStep2(); return; }
    // Next best: built-in navigation helpers
    if (typeof setActiveStep === 'function') { setActiveStep('step2'); return; }
    if (typeof setStep === 'function') { setStep(2); return; }
    if (typeof showStep === 'function') { showStep(2); return; }
  } catch (e) { console.warn('returnToStep2 nav api error:', e); }
  // DOM fallback + try to invoke renderers if present
  try {
    document.querySelectorAll('.screen').forEach(function(el){ el.style.display = 'none'; });
    var s2 = document.getElementById('screen-step2') || document.getElementById('step2');
    if (s2) {
      s2.style.display = '';
      s2.removeAttribute('hidden');
      s2.setAttribute('aria-hidden','false');
      s2.classList && s2.classList.remove('hidden','is-hidden','d-none');
    }
    // If the product grid is data-driven, attempt common renderers
    if (typeof renderAttachments === 'function') { try { renderAttachments(); } catch(e){} }
    if (typeof renderProducts === 'function') { try { renderProducts(); } catch(e){} }
    if (typeof initStep2 === 'function') { try { initStep2(); } catch(e){} }
    window.scrollTo({ top: 0, behavior: 'instant' });
  } catch (e) { console.warn('returnToStep2 fallback error:', e); }
}

      // If your app needs to re-render attachments on step switch:
      if (typeof renderAttachments === 'function') { try { renderAttachments(); } catch(e){} }
      window.scrollTo(0,0);
    } catch(e) {
      console.warn('[LC7] returnToStep2 failed:', e);
    }
  }

  // Wrap common close functions to always route back to Step 2
  function wrapClose(name){
    var fn = window[name];
    if (typeof fn !== 'function') return;
    if (fn.__lc7_wrapped) return;
    function wrapped(){
      try { return fn.apply(this, arguments); }
      finally { setTimeout(returnToStep2, 0); }
    }
    wrapped.__lc7_wrapped = true;
    window[name] = wrapped;
  }

  ['closeModal','hideModal','closePanel','hidePanel','dismissModal','closeDialog','hideDialog','closeSavePrint','hideSavePrint','closeContact','hideContact'].forEach(wrapClose);

  // Click-based close controls (delegated)
  document.addEventListener('click', function(e){
    var t = e.target;
    if (!t) return;
    // bubble up to find a close control
    var btn = t.closest('.modal-close, [data-close], [data-dismiss], [aria-label="Close"], [data-action="close"], #modalClose');
    if (btn) {
      setTimeout(returnToStep2, 0);
    }
  }, true);

  // Escape key closing
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' || e.keyCode === 27){
      // give existing handlers a tick to run, then route to Step 2
      setTimeout(returnToStep2, 0);
    }
  });

  // Observe #modal visibility changes; when it is hidden, go back to Step 2
  var modal = document.getElementById('modal');
  if (modal && typeof MutationObserver !== 'undefined'){
    var obs = new MutationObserver(function(){
      var style = getComputedStyle(modal);
      if (style && (style.display === 'none' || style.visibility === 'hidden')) {
        setTimeout(returnToStep2, 0);
      }
    });
    obs.observe(modal, { attributes: true, attributeFilter: ['style','class'] });
  }
})();
</script>
<!-- LC7 CLOSE PATCH END -->
<!-- LC7 SAVEPRINT PATCH START -->
<script>
// Ensure any Save/Print close navigates back to View & Select Equipment (Step 2)
(function(){
  // Helper to go to Step 2 and refresh the grid
  
function returnToStep2() {
  try {
    // Preferred: app-provided entry that also renders the grid
    if (typeof openStep2 === 'function') { openStep2(); return; }
    // Next best: built-in navigation helpers
    if (typeof setActiveStep === 'function') { setActiveStep('step2'); return; }
    if (typeof setStep === 'function') { setStep(2); return; }
    if (typeof showStep === 'function') { showStep(2); return; }
  } catch (e) { console.warn('returnToStep2 nav api error:', e); }
  // DOM fallback + try to invoke renderers if present
  try {
    document.querySelectorAll('.screen').forEach(function(el){ el.style.display = 'none'; });
    var s2 = document.getElementById('screen-step2') || document.getElementById('step2');
    if (s2) {
      s2.style.display = '';
      s2.removeAttribute('hidden');
      s2.setAttribute('aria-hidden','false');
      s2.classList && s2.classList.remove('hidden','is-hidden','d-none');
    }
    // If the product grid is data-driven, attempt common renderers
    if (typeof renderAttachments === 'function') { try { renderAttachments(); } catch(e){} }
    if (typeof renderProducts === 'function') { try { renderProducts(); } catch(e){} }
    if (typeof initStep2 === 'function') { try { initStep2(); } catch(e){} }
    window.scrollTo({ top: 0, behavior: 'instant' });
  } catch (e) { console.warn('returnToStep2 fallback error:', e); }
}
 catch(e){ console.warn('[LC7] returnToStep2 error', e); }
  }
  window.returnToStep2 = window.returnToStep2 || returnToStep2;

  // Attach close handlers inside save/print panels
  function attachSavePrintCloseHandlers(){
    // Candidate containers for the internal save/print window
    const containers = Array.from(document.querySelectorAll(
      '#savePrintModal, #savePrintPanel, [data-panel="saveprint"], .save-print, .saveprint, .savePrint'
    ));
    if (!containers.length) return;

    // Delegate close buttons
    const closeSelectors = [
      '.modal-close',
      '[data-close]',
      '[aria-label="Close"]',
      '#savePrintClose',
      '[data-action="close-saveprint"]',
      'button'
    ];

    containers.forEach(container => {
      // Avoid attaching multiple times
      if (container.__lc7_close_wired__) return;
      container.__lc7_close_wired__ = true;

      container.addEventListener('click', function(ev){
        const t = ev.target;
        // If it's a button-like element with "close" intent or matching selectors
        const isCloseIntent =
          (t.matches && closeSelectors.some(sel => t.matches(sel))) ||
          (t.closest && closeSelectors.some(sel => t.closest(sel))) ||
          /close/i.test((t.getAttribute && (t.getAttribute('aria-label')||'')) || '') ||
          /close|done|back/i.test((t.textContent||'').trim());

        if (isCloseIntent){
          // Defer to allow any existing handlers to run first
          setTimeout(returnToStep2, 0);
        }
      }, true);

      // Observe display/hide changes to route back when the panel is dismissed
      const obs = new MutationObserver(() => {
        const visible = container.offsetParent !== null && getComputedStyle(container).display !== 'none' && getComputedStyle(container).visibility !== 'hidden';
        if (!visible) {
          // Panel became hidden -> go back to step 2
          setTimeout(returnToStep2, 0);
        }
      });
      try {
        obs.observe(container, { attributes: true, attributeFilter: ['style', 'class'], subtree: false });
      } catch(e){ /* no-op */ }
    });
  }

  // Wrap openSavePrintInline to ensure handlers are attached whenever it's opened
  if (!window.__lc7_wrap_saveprint__){
    window.__lc7_wrap_saveprint__ = true;
    const originalOpen = window.openSavePrintInline;
    window.openSavePrintInline = function(){
      const out = originalOpen ? originalOpen.apply(this, arguments) : undefined;
      // Attach handlers after the panel has rendered
      setTimeout(attachSavePrintCloseHandlers, 0);
      return out;
    };
  }

  // In case native print is used from the panel
  window.addEventListener('afterprint', function(){
    // Give the UI a tick to settle
    setTimeout(returnToStep2, 0);
  });

  // Try attaching once on load (if the panel is already in DOM)
  if (document.readyState !== 'loading') attachSavePrintCloseHandlers();
  else document.addEventListener('DOMContentLoaded', attachSavePrintCloseHandlers);

  // Also watch for DOM changes that add the save/print panel later
  const bodyObs = new MutationObserver((muts)=>{
    for (const m of muts){
      if (m.addedNodes && m.addedNodes.length){
        for (const n of m.addedNodes){
          if (!(n instanceof Element)) continue;
          if (n.matches && (n.matches('#savePrintModal, #savePrintPanel, [data-panel="saveprint"], .save-print, .saveprint, .savePrint'))) {
            setTimeout(attachSavePrintCloseHandlers, 0);
            return;
          }
        }
      }
    }
  });
  try { bodyObs.observe(document.body, { childList: true, subtree: true }); } catch(e){ /* no-op */ }

})();
</script>
<!-- LC7 SAVEPRINT PATCH END -->
<div class="mobile-stepbar" id="mobileStepBar"><button id="msbStep1" type="button">View Equipment</button><button id="msbStep2" type="button">Save or Print Selections</button><button id="msbStep3" type="button">Send to Summit</button></div><script>
(function(){
  // Minimal renderer for Save/Print summary.
  // If your app defines selectedProducts(), use it. Otherwise, this will just show a message.
  function renderSavePrint(){
    var target = document.getElementById('savePrintTarget');
    if (!target) return;
    try {
      if (typeof selectedProducts === 'function') {
        var items = selectedProducts();
        if (items && items.length){
          target.innerHTML = items.map(function(p){
            var name = (p.ProductName || p.name || 'Item');
            var sku  = (p.SKU || p.sku || '');
            var price = (p.Price || p.price || '');
            return '<div class="card" style="margin:6px 0"><div class="body"><div style=\"display:flex;gap:12px;align-items:center\"><div style=\"flex:1 1 auto\"><div style=\"font-weight:800\">' + name + '</div><div class=\"muted\">SKU: ' + sku + '</div></div><div style=\"font-weight:800\">' + price + '</div></div></div></div>';
          }).join('');
        } else {
          target.innerHTML = '<div class="muted">No selections yet.</div>';
        }
      } else {
        target.innerHTML = '<div class="muted">Selections will appear here once chosen.</div>';
      }
    } catch(e){
      target.innerHTML = '<div class="muted">Unable to render selections.</div>';
    }
  }
  function wireSavePrint(){
    var btn = document.getElementById('printBtn');
    if (btn) btn.onclick = function(){ window.print(); };
  }
  // Hook when navigating
  var _setActiveStep = window.setActiveStep;
  window.setActiveStep = function(id){
    if (typeof _setActiveStep === 'function'){ _setActiveStep(id); }
    if (id === 'saveprint'){ renderSavePrint(); }
  };
  // Also render if we land directly
  document.addEventListener('DOMContentLoaded', function(){
    if (document.getElementById('screen-saveprint')?.classList.contains('active')){
      renderSavePrint();
    }
    wireSavePrint();
  });
})();</script><script>
(function(){
  function go(targetA, targetB){
    if (document.getElementById('screen-' + targetA)) { setActiveStep(targetA); }
    else if (targetB && document.getElementById('screen-' + targetB)) { setActiveStep(targetB); }
  }
  function wireStepbar(){
    var b1 = document.getElementById('msbStep1');
    var b2 = document.getElementById('msbStep2');
    var b3 = document.getElementById('msbStep3');
    if (b1) b1.onclick = function(){ go('step2'); };
    if (b2) b2.onclick = function(){ go('saveprint','step2'); };
    if (b3) b3.onclick = function(){ go('contact-intro','contact'); };
  }
  document.addEventListener('DOMContentLoaded', wireStepbar);
  setTimeout(wireStepbar, 300);
})();</script><script>
(function(){
  function getThumb(p){
    try{
      if (typeof getImages === 'function'){
        var imgs = getImages(p);
        if (imgs && imgs[0]) return imgs[0];
      }
      var u = p.ImageURLs || p.image || p.Image || '';
      if (u){
        var first = String(u).split(/[\n,;|]/)[0].trim();
        if (first) return first;
      }
      for (var k in p){
        if (/^image\s*\d+$/i.test(k) && p[k]) return p[k];
      }
    }catch(e){}
    return '';
  }

  function renderSavePrint(){
    var target = document.getElementById('savePrintTarget');
    if (!target) return;
    var items = (typeof selectedProducts === 'function') ? selectedProducts() : [];
    if (!items || !items.length){
      target.innerHTML = '<div class="muted">No selections yet.</div>';
      return;
    }
    var html = items.map(function(p){
      var img = getThumb(p);
      var name = p.ProductName || p.name || 'Item';
      var sku  = p.SKU || p.sku || '';
      var price = p.Price || p.price || '';
      return (
        '<div class="card" style="margin:8px 0">' +
          '<div class="body" style="display:flex; gap:12px; align-items:center">' +
            '<div style="width:88px;height:66px; flex:0 0 auto; background:#eef2f2; border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center">' +
              (img ? '<img src="' + img + '" alt="" style="max-width:100%;max-height:100%;object-fit:contain">' : '<span class="muted" style="font-size:.85rem">No image</span>') +
            '</div>' +
            '<div style="flex:1 1 auto">' +
              '<div style="font-weight:800">' + name + '</div>' +
              '<div class="muted">SKU: ' + sku + '</div>' +
            '</div>' +
            '<div style="font-weight:800">' + price + '</div>' +
          '</div>' +
        '</div>'
      );
    }).join('');
    target.innerHTML = html;
  }

  // Expose and use our enhanced renderer
  window.renderSavePrint = renderSavePrint;

  // If the save/print screen is active on load, render immediately
  document.addEventListener('DOMContentLoaded', function(){
    var sec = document.getElementById('screen-saveprint');
    if (sec && sec.classList.contains('active')){
      renderSavePrint();
    }
  });
})();
</script><script>
(function(){
  function go(targetA, targetB){
    if (document.getElementById('screen-' + targetA)) { setActiveStep(targetA); }
    else if (targetB && document.getElementById('screen-' + targetB)) { setActiveStep(targetB); }
  }
  function wireHeaderSteps(){
    // Find header steps (first .steps group)
    var stepsWrap = document.querySelector('.steps');
    if (!stepsWrap) return;
    var items = stepsWrap.querySelectorAll('.step');
    if (!items || !items.length) return;

    // Map first three items to desired behavior, regardless of current text/data-step
    if (items[0]) items[0].onclick = function(){ go('step2'); };
    if (items[1]) items[1].onclick = function(){ go('saveprint','step2'); };
    if (items[2]) items[2].onclick = function(){ go('contact-intro','contact'); };
  }

  document.addEventListener('DOMContentLoaded', wireHeaderSteps);
  // In case header is rendered later by app logic
  setTimeout(wireHeaderSteps, 300);
  setTimeout(wireHeaderSteps, 1000);
})();
</script><script>
(function(){
  function parsePrice(v){
    if (v == null) return 0;
    var s = String(v).trim();
    if (!s) return 0;
    // remove currency symbols and commas
    s = s.replace(/[^0-9.\-]/g, '');
    // handle blanks or malformed
    if (!s || s === '.' || s === '-' || s === '-.' ) return 0;
    var n = parseFloat(s);
    return isNaN(n) ? 0 : n;
  }
  function formatUSD(n){
    try{
      return new Intl.NumberFormat('en-US', { style:'currency', currency:'USD', minimumFractionDigits:2 }).format(n || 0);
    }catch(_){
      return '$' + (Math.round((n||0)*100)/100).toFixed(2);
    }
  }
  function getThumb(p){
    try{
      if (typeof getImages === 'function'){
        var imgs = getImages(p);
        if (imgs && imgs[0]) return imgs[0];
      }
      var u = p.ImageURLs || p.image || p.Image || '';
      if (u){
        var first = String(u).split(/[\n,;|]/)[0].trim();
        if (first) return first;
      }
      for (var k in p){
        if (/^image\s*\d+$/i.test(k) && p[k]) return p[k];
      }
    }catch(e){}
    return '';
  }
  // Override/define renderSavePrint
  window.renderSavePrint = function(){
    var target = document.getElementById('savePrintTarget');
    var totalEl = document.getElementById('savePrintTotal');
    if (!target) return;
    var items = (typeof selectedProducts === 'function') ? selectedProducts() : [];
    if (!items || !items.length){
      target.innerHTML = '<div class="muted">No selections yet.</div>';
      if (totalEl) totalEl.textContent = 'Total: ' + formatUSD(0);
      return;
    }
    var total = 0;
    var html = items.map(function(p){
      var img = getThumb(p);
      var name = p.ProductName || p.name || 'Item';
      var sku  = p.SKU || p.sku || '';
      var priceStr = p.Price || p.price || '';
      var priceNum = parsePrice(priceStr);
      total += priceNum;
      return (
        '<div class="card" style="margin:8px 0">' +
          '<div class="body" style="display:flex; gap:12px; align-items:center">' +
            '<div style="width:88px;height:66px; flex:0 0 auto; background:#eef2f2; border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center">' +
              (img ? '<img src="' + img + '" alt="" style="max-width:100%;max-height:100%;object-fit:contain">' : '<span class="muted" style="font-size:.85rem">No image</span>') +
            '</div>' +
            '<div style="flex:1 1 auto">' +
              '<div style="font-weight:800">' + name + '</div>' +
              '<div class="muted">SKU: ' + sku + '</div>' +
            '</div>' +
            '<div style="font-weight:800">' + (priceStr || '') + '</div>' +
          '</div>' +
        '</div>'
      );
    }).join('');
    target.innerHTML = html;
    if (totalEl) totalEl.textContent = 'Total: ' + formatUSD(total);
  };

  // Render on activation of saveprint
  (function hookNav(){
    var _setActiveStep = window.setActiveStep;
    window.setActiveStep = function(id){
      if (typeof _setActiveStep === 'function'){ _setActiveStep(id); }
      if (id === 'saveprint'){ window.renderSavePrint && window.renderSavePrint(); }
    };
  })();

  // Also render on load if active
  document.addEventListener('DOMContentLoaded', function(){
    var sec = document.getElementById('screen-saveprint');
    if (sec && sec.classList.contains('active')){
      window.renderSavePrint && window.renderSavePrint();
    }
  });
})();
</script><script id="header-menu-disable">
(function(){
  function disableHeaderMenu(){
    var header = document.querySelector('header.appbar');
    if (!header) return;
    header.querySelectorAll('.steps .step').forEach(function(el){
      el.setAttribute('aria-disabled','true');
      el.classList.add('text-only');
      // prevent any click handling from bubbling up
      el.addEventListener('click', function(e){ e.stopPropagation(); e.preventDefault(); }, true);
    });
  }
  if (document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', disableHeaderMenu);
  } else {
    disableHeaderMenu();
  }
})();
</script>
<script id="step3-proceed-to-contact">
(function() {
  function openContact() {
    try {
      // If app has setActiveStep or show() use them; else scroll to section
      if (typeof setActiveStep === 'function') {
        // Common ids: 'contact' or 'saveprint' etc. We'll try a few.
        setActiveStep('contact');
      }
      if (typeof show === 'function' && document.getElementById('screen-contact-intro')) {
        try { show('screen-contact-intro'); } catch(e){}
      }
      var target = document.getElementById('screen-contact-intro');
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    } catch(e) { /* no-op */ }
  }
  // Bind any button in Step 3 with label "Proceed" (guarded to step3 scope)
  try {
    var step3 = document.getElementById('screen-step3') || document.getElementById('step3');
    if (!step3) return;
    var btns = step3.querySelectorAll('button, a');
    btns.forEach(function(b){
      var label = (b.textContent || b.innerText || '').trim().toLowerCase();
      if (label === 'proceed' || label === 'procced' || label.indexOf('proceed') === 0) {
        b.addEventListener('click', function(ev){
          ev.preventDefault();
          openContact();
        }, true);
      }
    });
  } catch(e) { /* no-op */ }
})();
</script>
<script>
// Unified modal close behavior: product details (#modal) and lead form (#leadModal)
// Close via: Close button, backdrop click, or ESC -> return to Step 2.
(function(){
  
function returnToStep2() {
  try {
    // Preferred: app-provided entry that also renders the grid
    if (typeof openStep2 === 'function') { openStep2(); return; }
    // Next best: built-in navigation helpers
    if (typeof setActiveStep === 'function') { setActiveStep('step2'); return; }
    if (typeof setStep === 'function') { setStep(2); return; }
    if (typeof showStep === 'function') { showStep(2); return; }
  } catch (e) { console.warn('returnToStep2 nav api error:', e); }
  // DOM fallback + try to invoke renderers if present
  try {
    document.querySelectorAll('.screen').forEach(function(el){ el.style.display = 'none'; });
    var s2 = document.getElementById('screen-step2') || document.getElementById('step2');
    if (s2) {
      s2.style.display = '';
      s2.removeAttribute('hidden');
      s2.setAttribute('aria-hidden','false');
      s2.classList && s2.classList.remove('hidden','is-hidden','d-none');
    }
    // If the product grid is data-driven, attempt common renderers
    if (typeof renderAttachments === 'function') { try { renderAttachments(); } catch(e){} }
    if (typeof renderProducts === 'function') { try { renderProducts(); } catch(e){} }
    if (typeof initStep2 === 'function') { try { initStep2(); } catch(e){} }
    window.scrollTo({ top: 0, behavior: 'instant' });
  } catch (e) { console.warn('returnToStep2 fallback error:', e); }
}

      if (typeof setStep === 'function') { setStep(2); return; }
      if (typeof showStep === 'function') { showStep(2); return; }
    } catch (e) { console.warn('returnToStep2 nav api error:', e); }
    // DOM fallback
    try {
      document.querySelectorAll('.screen').forEach(function(el){ el.style.display = 'none'; });
      var s2 = document.getElementById('screen-step2') || document.getElementById('step2');
      if (s2) {
        s2.style.display = '';
        s2.removeAttribute('hidden');
        s2.setAttribute('aria-hidden','false');
        s2.classList && s2.classList.remove('hidden','is-hidden','d-none');
      }
      window.scrollTo({ top: 0, behavior: 'instant' });
    } catch (e) { console.warn('returnToStep2 fallback error:', e); }
  }

  function hideModal(modal) {
    if (!modal) return;
    try {
      modal.style.display = 'none';
      modal.classList && modal.classList.remove('open','show','is-active');
      modal.setAttribute('aria-hidden','true');
    } catch (e) {}
  }

  function closeModalAndReturn(ev) {
    try {
      if (ev) {
        ev.preventDefault();
        ev.stopPropagation();
        if (ev.stopImmediatePropagation) ev.stopImmediatePropagation();
      }
      var modal = (this && this.closest) ? this.closest('.modal') : null;
      // If called from backdrop or ESC, 'this' may be window or the modal itself
      if (!modal && ev && ev.currentTarget && ev.currentTarget.classList && ev.currentTarget.classList.contains('modal')) {
        modal = ev.currentTarget;
      }
      // As a final fallback, if any modal is open, hide it
      if (!modal) {
        modal = Array.from(document.querySelectorAll('#modal, #leadModal')).find(function(m){
          var cs = getComputedStyle(m);
          return cs.display !== 'none' && m.getAttribute('aria-hidden') !== 'true';
        }) || null;
      }
      hideModal(modal);
    } catch (e) { console.warn('closeModalAndReturn error', e); }
    returnToStep2();
    return false;
  }

  function wireModalBehavior(modalId, closeBtnId) {
    var modal = document.getElementById(modalId);
    if (!modal) return;

    // Avoid double-wiring
    if (!modal.__wiredUnifiedClose) {
      modal.__wiredUnifiedClose = true;

      // Backdrop click (capture): only if click target is the modal (not inside dialog)
      modal.addEventListener('click', function(e){
        if (e.target === modal) closeModalAndReturn(e);
      }, true);

      // ESC when this modal is open
      if (!window.__wiredUnifiedEsc) {
        window.__wiredUnifiedEsc = true;
        window.addEventListener('keydown', function(e){
          if (e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27) {
            var open = Array.from(document.querySelectorAll('#modal, #leadModal')).some(function(m){
              var cs = getComputedStyle(m);
              return cs.display !== 'none' && m.getAttribute('aria-hidden') !== 'true';
            });
            if (open) closeModalAndReturn(e);
          }
        }, true);
      }
    }

    // Wire the dedicated close button if present
    var btn = document.getElementById(closeBtnId);
    if (btn && !btn.__wiredUnifiedCloseBtn) {
      btn.__wiredUnifiedCloseBtn = true;
      btn.addEventListener('click', closeModalAndReturn, true);
    }

    // Wire any .close buttons inside the modal
    modal.querySelectorAll('.close').forEach(function(b){
      if (!b.__wiredUnifiedCloseBtn) {
        b.__wiredUnifiedCloseBtn = true;
        b.addEventListener('click', closeModalAndReturn, true);
      }
    });
  }

  function wireAll() {
    wireModalBehavior('modal', 'modalClose');       // Product Details modal
    wireModalBehavior('leadModal', 'leadModalClose'); // Lead Form modal
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', wireAll);
  } else {
    wireAll();
  }

  // Re-wire on DOM changes (in case modal content gets re-rendered)
  var ob = new MutationObserver(wireAll);
  ob.observe(document.documentElement, { childList: true, subtree: true });
})();
</script><script id="pdf-viewer-unified">
(function(){
  if (window.__pdfViewerUnified) return;
  window.__pdfViewerUnified = true;

  function isPdf(url){
    try { return /\.pdf(\?|$)/i.test(String(url||'')); } catch(_) { return false; }
  }
  function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  // Ensure modal structure exists
  function ensureModal(){
    var modal = document.getElementById('modal') || document.querySelector('.modal');
    if (!modal){
      modal = document.createElement('div');
      modal.id = 'modal';
      modal.className = 'modal';
      document.body.appendChild(modal);
    }
    var title = document.getElementById('modalTitle') || modal.querySelector('#modalTitle, .modal-title');
    if (!title){
      title = document.createElement('div');
      title.id = 'modalTitle';
      modal.appendChild(title);
    }
    var content = document.getElementById('modalContent') || modal.querySelector('#modalContent, .modal-content');
    if (!content){
      content = document.createElement('div');
      content.id = 'modalContent';
      modal.appendChild(content);
    }
    var close = document.getElementById('modalClose') || modal.querySelector('#modalClose, .close');
    if (!close){
      close = document.createElement('button');
      close.id = 'modalClose';
      close.className = 'close';
      close.textContent = 'Close';
      modal.insertBefore(close, modal.firstChild);
      close.addEventListener('click', function(){
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden','true');
      }, true);
    }
    modal.style.display = 'block';
    modal.setAttribute('aria-hidden','false');
    return { modal, title, content };
  }

  function renderPdfInModal(url, docTitle){
    var parts = ensureModal();
    var modal = parts.modal, title = parts.title, content = parts.content;
    var safeUrl = String(url||'');
    var safeTitle = escapeHtml(docTitle||'Document');

    // Toolbar
    var toolbar = ''
      + '<div class="pdf-toolbar" role="toolbar">'
      + '  <button type="button" class="pdf-btn" data-act="open">Open in New Tab</button>'
      + '  <button type="button" class="pdf-btn" data-act="download">Download</button>'
      + '  <button type="button" class="pdf-btn" data-act="print">Print</button>'
      + '</div>';

    // Iframe (native viewer params)
    var iframeHtml = '<iframe class="pdf-frame" title="'+ safeTitle +'" '
      + 'src="'+ safeUrl + '#toolbar=1&navpanes=1&view=FitH" loading="lazy"></iframe>';

    title.innerHTML = safeTitle;
    content.innerHTML = toolbar + '<div class="pdf-frame-wrap">' + iframeHtml + '</div>';

    // Wire toolbar
    content.querySelectorAll('.pdf-toolbar .pdf-btn').forEach(function(btn){
      btn.addEventListener('click', function(){
        var act = btn.getAttribute('data-act');
        if (act === 'open'){
          window.open(safeUrl, '_blank', 'noopener');
        } else if (act === 'download'){
          var a = document.createElement('a'); a.href = safeUrl; a.download = '';
          document.body.appendChild(a); a.click(); a.remove();
        } else if (act === 'print'){
          try {
            var frame = content.querySelector('.pdf-frame');
            if (frame && frame.contentWindow) { frame.contentWindow.focus(); frame.contentWindow.print(); }
            else { var w = window.open(safeUrl, '_blank'); if (w) w.print(); }
          } catch(e){ window.open(safeUrl, '_blank'); }
        }
      }, {passive:true});
    });
  }

  // Intercept openViewer for PDFs (used by View Brochure / View Manual buttons)
  var _openViewer = window.openViewer;
  window.openViewer = function(title, url){
    if (isPdf(url)) { renderPdfInModal(url, title); return; }
    if (typeof _openViewer === 'function') return _openViewer(title, url);
    window.open(url, '_blank', 'noopener');
  };

  // Also intercept direct clicks in the Product Details modal that point to PDFs
  document.addEventListener('click', function(e){
    var a = e.target.closest('a, button');
    if (!a) return;
    // Accept data-url, href, or onclick data
    var url = a.getAttribute('data-url') || a.getAttribute('href') || '';
    var title = a.getAttribute('data-title') || a.getAttribute('title') || a.textContent.trim() || 'Document';
    if (isPdf(url)){
      e.preventDefault();
      renderPdfInModal(url, title);
    }
  }, true);

  // Styles for consistent viewer sizing and toolbar on mobile/tablet/desktop
  var css = document.createElement('style');
  css.id = 'pdf-viewer-unified-style';
  css.textContent = `
  #modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; }
  #modalContent { background:#fff; max-width: 1000px; width: 94vw; margin: 5vh auto; border-radius: 10px; overflow: hidden; }
  #modalTitle { padding: 12px 16px; font-weight: 600; border-bottom: 1px solid rgba(0,0,0,0.1); background:#fff; position: sticky; top: 0; z-index: 2; }
  .pdf-toolbar { display:flex; gap:8px; padding:10px; border-bottom:1px solid rgba(0,0,0,0.08); background:#f7f7f7; position: sticky; top: 44px; z-index: 2; }
  .pdf-btn { padding:8px 12px; border:1px solid rgba(0,0,0,0.15); background:#fff; border-radius:8px; cursor:pointer; }
  .pdf-frame-wrap { height: 70vh; }
  .pdf-frame { width:100%; height:100%; border:none; }
  @media (max-width:1024px){ #modalContent { width:94vw; margin:4vh auto; } .pdf-frame-wrap { height:72vh; } }
  @media (max-width:640px){ #modalContent { width:96vw; margin:3vh auto; } .pdf-frame-wrap { height:70vh; } }
  `;
  document.head.appendChild(css);
})();
</script></body></html>';

  var w = window.open('', '_blank');
  if (!w) { alert('Pop-up blocked. Please allow pop-ups for this site.'); return; }
  w.document.open(); w.document.write(docHTML); w.document.close();
  setTimeout(function(){ try{ w.focus(); w.print(); }catch(e){} }, 200);
}

<script>
// Ensure header menu sits with the logo and stays present
document.addEventListener('DOMContentLoaded', function(){
  function wire(el, step, fn){
    el.addEventListener('click', function(){
      try { setActiveStep(step); } catch(e){}
      if (fn) try { fn(); } catch(e){}
    });
  }
  document.querySelectorAll('.steps .step[data-step="step2"]').forEach(el=>wire(el,'step2',null));
  document.querySelectorAll('.steps .step[data-step="saveprint"]').forEach(el=>wire(el,'saveprint', (window.printSelectionsPDF||null)));
  document.querySelectorAll('.steps .step[data-step="contact"]').forEach(el=>wire(el,'contact', (window.showContactBenefit||null)));
});
</script>
<script>
  // === Inline Save/Print (no external PDF) ===
  (function(){
    if (window.__inlineSavePrintBound) return;
    window.__inlineSavePrintBound = true;

    window.openSavePrintInline = function(){
      try{
        var modal = document.getElementById('modal');
        var titleEl = document.getElementById('modalTitle');
        var content = document.getElementById('modalContent');
        if (!modal || !titleEl || !content) return alert('Viewer not available.');

        // Build a simple, printable summary of current selections
        function esc(s){ return String(s||''); }
        function getImage(p){
          try{
            if (typeof getImages === 'function'){
              var imgs = getImages(p);
              return imgs && imgs[0] ? imgs[0] : '';
            }
          }catch(e){}
          return '';
        }
        function selectedProducts(){
          var out = [];
          try{
            if (window.state){
              if (state.tractors && state.tractors.size){
                Array.from(state.tractors).forEach(function(id){
                  var it = state.data.find(function(d){ return String(d.ProductID)===String(id); });
                  if (it) out.push(it);
                });
              }
              if (state.attachments){
                state.attachments.forEach(function(id){
                  var it = state.data.find(function(d){ return String(d.ProductID)===String(id); });
                  if (it) out.push(it);
                });
              }
            }
          }catch(e){}
          return out;
        }

        var items = selectedProducts();
        titleEl.textContent = 'Your Selections — Save or Print';
        if (!items.length){
          content.innerHTML = '<button class="player-close" type="button" aria-label="Close">×</button><div style="padding:12px;"><p>No products selected yet.</p></div>';
          var closeBtn = content.querySelector('.player-close');
          if (closeBtn) closeBtn.onclick = function(){ modal.style.display='none'; };
          modal.style.display = 'flex';
          return;
        }

        var rows = items.map(function(p, idx){
          var img = getImage(p);
          return (
            '<tr>' +
              '<td style="padding:8px; vertical-align:top;">' + (idx+1) + '</td>' +
              '<td style="padding:8px; vertical-align:top;">' + esc(p.ProductName) + '<div class="muted" style="font-size:12px;">Model: ' + esc(p.Model) + ' &nbsp; | &nbsp; SKU: ' + esc(p.SKU) + '</div></td>' +
              '<td style="padding:8px; vertical-align:top; white-space:nowrap;">' + esc(p.Price) + '</td>' +
              '<td style="padding:8px; vertical-align:top; width:120px;">' + (img ? '<img src="'+img+'" alt="" style="max-width:120px; max-height:80px; object-fit:contain;"/>' : '') + '</td>' +
            '</tr>'
          );
        }).join('');

        content.innerHTML = ''
          + '<button class="player-close" type="button" aria-label="Close">×</button>'
          + '<div id="printArea" style="padding:12px;">'
          + '  <h2 style="margin:0 0 6px 0;">Summit Tractors — Saved Selections</h2>'
          + '  <p class="muted" style="margin:0 0 12px 0;">Print or download your list. PDFs, brochures, and manuals open inside the app.</p>'
          + '  <table style="width:100%; border-collapse:collapse;">'
          + '    <thead>'
          + '      <tr style="text-align:left; border-bottom:1px solid #e5e7eb;">'
          + '        <th style="padding:8px;">#</th>'
          + '        <th style="padding:8px;">Product</th>'
          + '        <th style="padding:8px;">Price</th>'
          + '        <th style="padding:8px;">Image</th>'
          + '      </tr>'
          + '    </thead>'
          + '    <tbody>' + rows + '</tbody>'
          + '  </table>'
          + '</div>'
          + '<div class="sticky-actions no-print">'
          + '  <button id="sp_print" type="button">Print</button>'
          + '  <button id="sp_csv" class="secondary" type="button">Download CSV</button>'
          + '  <button id="sp_json" class="secondary" type="button">Download JSON</button>'
          + '</div>';

        // Wire controls
        var closeBtn = content.querySelector('.player-close');
        if (closeBtn) closeBtn.onclick = function(){ modal.style.display='none'; };
        var btnPrint = content.querySelector('#sp_print');
        if (btnPrint) btnPrint.onclick = function(){ window.print(); };
        var btnCSV = content.querySelector('#sp_csv');
        if (btnCSV) btnCSV.onclick = function(){ try{ (window.downloadCSV||function(){alert("CSV export unavailable");})(); }catch(e){ alert("CSV export unavailable"); } };
        var btnJSON = content.querySelector('#sp_json');
        if (btnJSON) btnJSON.onclick = function(){ try{ (window.downloadJSON||function(){alert("JSON export unavailable");})(); }catch(e){ alert("JSON export unavailable"); } };

        modal.style.display = 'flex';
      }catch(err){
        console.warn('openSavePrintInline error:', err);
        alert('Sorry—could not open Save/Print viewer.');
      }
    };
  })();
</script>
<script>
  (function(){
    // Force "Save or Print Your Selections" to open inline viewer, without external pop-ups
    try {
      document.querySelectorAll('.step[data-step="saveprint"]').forEach(function(st){
        st.addEventListener('click', function(){
          try { setActiveStep('saveprint'); } catch(e){}
          try { openSavePrintInline(); } catch(e){ console.warn(e); }
        });
      });
    } catch(e){ console.warn('saveprint bind error', e); }
  })();
</script>
<script>
(function(){
  function stripStrayPopupText(root){
    try {
      var walker = document.createTreeWalker(root || document.body, NodeFilter.SHOW_TEXT, null);
      var kill = [];
      var re = /(var\s+w\s*=\s*window\.open|Pop-?up\s+blocked|w\.document\.write\s*\(\s*docHTML\s*\))/i;
      while (walker.nextNode()) {
        var n = walker.currentNode;
        if (!n || !n.nodeValue) continue;
        var txt = n.nodeValue.trim();
        if (!txt) continue;
        if (re.test(txt)) kill.push(n);
      }
      for (var i=0; i<kill.length; i++){ kill[i].nodeValue = ""; }
    } catch(e) { /* no-op */ }
  }
  function initCleanup(){
    stripStrayPopupText(document.body);
    var mo = new MutationObserver(function(mutations){
      for (var i=0; i<mutations.length; i++){
        var added = mutations[i].addedNodes || [];
        for (var j=0; j<added.length; j++){
          var node = added[j];
          if (node.nodeType === 3) {
            var t = (node.nodeValue || "").trim();
            if (/(var\s+w\s*=\s*window\.open|Pop-?up\s+blocked|w\.document\.write\s*\(\s*docHTML\s*\))/i.test(t)) {
              node.nodeValue = "";
            }
          } else if (node.nodeType === 1) {
            stripStrayPopupText(node);
          }
        }
      }
    });
    try { mo.observe(document.body, { childList: true, subtree: true }); } catch(_) {}
  }
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initCleanup);
  } else {
    initCleanup();
  }
})();
</script>
<script>
// === Save/Print: always return to "View & Select Equipment" after user finishes ===
(function(){
  // Robust navigation back to View & Select
  function goToViewSelect(){
    try { if (typeof setActiveStep === "function") { setActiveStep("step2"); return; } } catch(e){}
    try { if (typeof showScreen === "function") { showScreen("screen-step2"); return; } } catch(e){}
    // Fallback: basic show/hide
    try {
      var screens = document.querySelectorAll('[id^="screen-"]');
      screens.forEach(function(s){ s.style.display = (s.id === "screen-step2") ? "" : "none"; });
      window.scrollTo({top:0, behavior:"smooth"});
    } catch(e){}
  }

  // ---- INTERNAL (in-app) viewer hooks ----
  // If your in-app viewer uses a modal with close/print buttons, wire those to return.
  function bindInternalViewer(){
    // Common ids/classes used earlier in this project
    var modal = document.getElementById("pdfViewerModal") || document.getElementById("modal");
    var closeBtn = document.getElementById("pdfCloseBtn") || (modal ? modal.querySelector(".player-close, .modal-close") : null);
    var printBtn = document.getElementById("pdfPrintBtn") || document.getElementById("sp_print");

    if (closeBtn && !closeBtn.dataset._returnBound){
      closeBtn.dataset._returnBound = "1";
      closeBtn.addEventListener("click", function(){ setTimeout(goToViewSelect, 0); });
    }
    if (printBtn && !printBtn.dataset._returnBound){
      printBtn.dataset._returnBound = "1";
      // After user-initiated print finishes, return
      window.addEventListener("afterprint", function handler(){
        window.removeEventListener("afterprint", handler);
        setTimeout(goToViewSelect, 100);
      });
    }
  }

  // ---- EXTERNAL (popup) viewer hooks ----
  // Intercept window.open to keep it in-app for PDFs; if a popup still opens, close on user finish.
  if (!window.__savePrintWrapped){
    window.__savePrintWrapped = true;
    var origOpen = window.open;
    window.open = function(url, target, feat){
      try {
        var isPdf = typeof url === "string" &&
                    (/\\.pdf(\\?|#|$)/i.test(url) || url.startsWith("data:application/pdf") || url.startsWith("blob:"));
        if (isPdf){
          // Prefer in-app viewer if available
          if (typeof openInAppPDF === "function"){ openInAppPDF(url); return null; }
          // Fallback: open popup but monitor closure
          var w = origOpen.apply(window, arguments);
          try {
            var timer = setInterval(function(){
              if (!w || w.closed){ clearInterval(timer); goToViewSelect(); }
            }, 700);
          } catch(_) {}
          return w;
        }
      } catch(_) {}
      return origOpen.apply(window, arguments);
    };
  }

  // Bind now and also after DOM is ready for internal buttons
  if (document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", bindInternalViewer);
  } else {
    bindInternalViewer();
  }
  // Re-bind if UI re-renders buttons
  var mo = new MutationObserver(function(){ bindInternalViewer(); });
  try { mo.observe(document.body, { childList:true, subtree:true }); } catch(_) {}
})();
</script>
<script>
function buildSummaryCard(p){
  try {
    const imgs = (typeof getImages==='function') ? getImages(p) : [];
    const main = (imgs && imgs[0]) || p.ImageURL || p.PrimaryImageURL || '';
    const sel = (window.state && state.attachments && state.attachments.has) ? state.attachments.has(p.ProductID) : false;
    const short = (p.DescriptionShort || '').trim();
    return `
      <div class="card" data-prod="${p.ProductID}">
        <div class="media">${main ? `<img src="${main}" alt="${p.ProductName||'image'}">` : '<div class="muted">No image</div>'}</div>
        <div class="body">
          <h3>${p.ProductName || 'Product'}</h3>
          ${short ? `<p class="muted" style="margin-top:6px">${short}</p>` : ''}
          <div class="actions">
            <button data-add="${p.ProductID}" type="button">${sel ? 'Remove' : 'Select'}</button>
            <button class="secondary" data-preview="${p.ProductID}" type="button">Preview</button>
            <button class="see-details" data-details="${p.ProductID}" type="button">See Details</button>
          </div>
        </div>
      </div>`;
  } catch(e){
    // Fallback to existing detail card if anything goes wrong
    try {
      const base = buildDetailCard(p);
      const sel = state.attachments.has(p.ProductID);
      const extras = `
        <button data-add="${p.ProductID}" type="button">${sel ? 'Remove' : 'Select'}</button>
        <button class="secondary" data-preview="${p.ProductID}" type="button">Preview</button>
        <button class="see-details" data-details="${p.ProductID}" type="button">See Details</button>
      `;
      return base.replace('<div class="actions">', `<div class="actions">${extras}`);
    } catch(_) {
      return '<div class="card"><div class="body"><div class="muted">Unable to render card.</div></div></div>';
    }
  }
}

function openDetailModal(id){
  try{
    const p = (typeof getProd==='function') ? getProd(id) : (state && state.data ? state.data.find(d=>d.ProductID===id) : null);
    if (!p) return;
    var modal = document.getElementById('modal');
    var titleEl = document.getElementById('modalTitle');
    var content = document.getElementById('modalContent');
    if (!modal || !titleEl || !content){
      // Fallback: replace inline card with detail card markup
      const host = document.querySelector('.card[data-prod="'+id+'"]');
      if (host){
        let html = buildDetailCard(p);
        html = html.replace('<div class="actions">', '<div class="actions"><button class="see-details" type="button" onclick="location.reload()">Hide Details</button>');
        host.outerHTML = '<div class="card">'+html+'</div>';
      }
      return;
    }
    titleEl.textContent = p.ProductName || 'Details';
    content.innerHTML = buildDetailCard(p);
    modal.style.display = 'flex';
  } catch(e){}
}
</script>
<script>
function openStep2() {
  if (typeof setStep === 'function') setStep(2);
  if (typeof showStep === 'function') showStep(2);
  if (document.getElementById('step2')) {
    document.getElementById('step2').style.display = '';
  }
  if (typeof renderAttachments === 'function') renderAttachments();
}
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('viewSelectEquipment')
    || document.querySelector('[data-action="view-select-equipment"]')
    || document.querySelector('button[title="View & Select Equipment"]')
    || document.querySelector('button:contains("View & Select Equipment")');
  if (btn) btn.addEventListener('click', openStep2);
});
</script>
<script>
  (function(){
    function stopViewer(){
      const content = document.getElementById('modalContent');
      if (!content) return;
      // Pause and unload any <video>
      content.querySelectorAll('video').forEach(v => {
        try { v.pause(); } catch(e) {}
        v.removeAttribute('src');
        v.load();
      });
      // Unload any YouTube/other iframes
      content.querySelectorAll('iframe').forEach(f => {
        try { f.src = 'about:blank'; } catch(e) {}
      });
      // Clear the content to fully detach players
      content.innerHTML = '';
    }
    window.stopViewer = stopViewer;

    // Override openViewer again to wire improved close behavior
    window.openViewer = function(title, url){
      const modal = document.getElementById('modal');
      const titleEl = document.getElementById('modalTitle');
      const content = document.getElementById('modalContent');
      titleEl.textContent = title;

      function closeAll(){
        stopViewer();
        modal.style.display = 'none';
      }

      const isYouTube = (u => {
        try {
          const _u = new URL(u);
          return /(^|\.)youtube\.com$/.test(_u.hostname) || /(^|\.)youtu\.be$/.test(_u.hostname);
        } catch { return false; }
      })(url);

      function toEmbed(u){
        try {
          const U = new URL(u);
          let id='';
          if (U.hostname.includes('youtu.be')) id = U.pathname.replace(/^\/+/, '');
          else if (U.pathname.startsWith('/shorts/')) id = U.pathname.split('/')[2] || '';
          else id = U.searchParams.get('v') || '';
          if (!id) return null;
          const params = new URLSearchParams({ rel:'0', modestbranding:'1', playsinline:'1' });
          return `https://www.youtube.com/embed/${id}?${params.toString()}`;
        } catch { return null; }
      }

      const isMP4 = /\.mp4($|\?)/i.test(url||'');
      if (isYouTube){
        const src = toEmbed(url) || url;
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <div style="position:relative;padding-top:56.25%;">
            <iframe
              src="${src}"
              title="Video player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen
              style="position:absolute;inset:0;width:100%;height:100%;border:0;"
            ></iframe>
          </div>`;
      } else if (isMP4){
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <video src="${url}" controls playsinline style="width:100%;max-height:70vh;"></video>`;
      } else {
        content.innerHTML = `
          <button class="player-close" type="button" aria-label="Close">×</button>
          <iframe src="${url}" style="width:100%;height:70vh;border:0;"></iframe>`;
      }

      const x = content.querySelector('.player-close');
      if (x) x.addEventListener('click', closeAll);

      modal.style.display = 'flex';

      const escHandler = (e) => {
        if (e.key === 'Escape') {
          closeAll();
          document.removeEventListener('keydown', escHandler);
        }
      };
      document.addEventListener('keydown', escHandler, { once: true });

      // Also ensure the header "Close" button stops playback
      const headerClose = document.getElementById('modalClose');
      if (headerClose){
        headerClose.onclick = closeAll;
      }
    };

    // As a final safety net, if something else closes the modal, stop players
    document.addEventListener('click', (e) => {
      const modal = document.getElementById('modal');
      if (!modal) return;
      if (modal.style.display !== 'flex') return;
    });
  })();
</script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  function bindOpenStep2(){
    const candidates = [
      document.getElementById('viewSelectEquipment'),
      document.getElementById('nextToStep2'),
      document.querySelector('[data-action="view-select-equipment"]'),
      document.querySelector('button[title="View & Select Equipment"]')
    ].filter(Boolean);

    // Also find by text content
    document.querySelectorAll('button, a.btn, .btn').forEach(el => {
      if (!el) return;
      const t = (el.textContent || '').trim();
      if (/view\s*&?\s*select\s*equipment/i.test(t)) candidates.push(el);
    });

    candidates.forEach(btn => {
      if (!btn.__wiredOpenStep2){
        btn.__wiredOpenStep2 = true;
        btn.addEventListener('click', function(ev){
          if (typeof openStep2 === 'function') openStep2();
          else if (typeof setActiveStep === 'function') setActiveStep('step2');
          // ensure render
          if (typeof renderAttachments === 'function') renderAttachments();
        });
      }
    });
  }
  bindOpenStep2();
});

// Ensure Lead Form "Close" returns user to View & Select Equipment (Step 2)
(function(){
  const leadClose = document.getElementById('leadClose');
  if (leadClose){
    leadClose.addEventListener('click', function(){
      try {
        var lm = document.getElementById('leadModal');
        if (lm) lm.style.display = 'none';
        if (typeof setActiveStep === 'function') setActiveStep('step2');
      } catch(e){ console.warn('leadClose error:', e); }
    });
  }
})();
</script>
